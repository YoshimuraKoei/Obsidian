
KWï¼šISBNã€openBDã€Google Books APIã€æ©Ÿæ¢°å­¦ç¿’

## èƒŒæ™¯

æ›¸ç±ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å—ã‘å–ã£ãŸã®ã¯ã„ã„ãŒã€ã‚«ãƒ©ãƒ ã®è‡ªç”±åº¦ãŒä½ã‹ã£ãŸã®ã§ã€ISBNã§openBDçµŒç”±ã—ã¦é–¢é€£æƒ…å ±ã‚’å–å¾—ã—ãŸã„ã¨ã„ã†ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã€‚

çŠ¶æ³ï¼š
- ç´„200,000ä»¶ã®ISBNã§æ¤œç´¢ã‹ã‘ã¦ã€æ›¸ç±ã®å‘¨è¾ºæƒ…å ±ã‚’å–å¾—ã—ãŸã„(ä¸»ã«å’Œæ›¸)

## è¦ä»¶

è¦ä»¶ï¼š
- å‡ºç‰ˆæ—¥ã€æ›¸ç±åãªã©ã®æœ€ä½é™ã®æƒ…å ±ã‚’æŒã£ã¦ã„ã‚‹ã“ã¨
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒæ—©ãã€æ•°æ™‚é–“ä»¥å†…ã§çµ‚ã‚ã‚‹ã“ã¨
- ç„¡æ–™ã§ã‚ã‚‹ã“ã¨

[ISBNæ›¸ç±æ¤œç´¢APIã«ã¤ã„ã¦èª¿ã¹ã‚‹](https://zenn.dev/banboobloom/articles/2025012600001)
â†‘ ã®è¨˜äº‹ã‚’å‚è€ƒã«ã€

1. [æ¥½å¤©ãƒ–ãƒƒã‚¯ã‚¹æ›¸ç±æ¤œç´¢APIï¼ˆBooks Book Search APIï¼‰](https://webservice.rakuten.co.jp/documentation/books-book-search)
2. [Google Books API](https://developers.google.com/books/?hl=ja)
3. [openBD](https://openbd.jp/)

ã“ã‚Œã‚‰3ã¤ã®APIã‚’æ¤œè¨ã—ãŸã€‚

â‘ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒæ—©ã„
â‘¡1ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§MAX100ä»¶å–å¾—ã§ãã‚‹
â‘¢APIã‚­ãƒ¼ã‚’ç™ºè¡Œã™ã‚‹ã“ã¨ãŒãªã„
â‘£ä½¿ç”¨æ³•ãŒã‚·ãƒ³ãƒ—ãƒ«

ã“ã‚Œã‚‰ã®é¢ã§ã€openBDã‚’æ¡ç”¨ã€‚

ã¡ãªã¿ã«Google Books APIã‚‚è©¦ã—ãŸã€‚

- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ 1,000ãƒªã‚¯ã‚¨ã‚¹ãƒˆ / æ—¥ 
	- ä¸Šé™å¼•ãä¸Šã’ã®å¯©æŸ»è½ã¡ï¼š`Thank you for contacting Google Books. At this time we are unable to approve requests for an increased quota for the Google Books API. We do not have an estimated time as to when we will be able to approve said requests. We apologize for any inconvenience and thank you for your understanding.`
- 1ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§1ä»¶ã—ã‹å–å¾—ã§ããªã„

ã“ã‚Œã‚‰ãŒä¸ä¾¿ã ã£ãŸã€‚
Google Books APIã¯openBDã«ãªã„ã‚µãƒ ãƒã‚¤ãƒ«URLãªã©ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æƒ…å ±é‡ãŒå¤šã„ã“ã¨ã¯å¼·ã¿ã ãŒ...

## openBD ä½¿ç”¨æ–¹æ³•

ä¸‹è¨˜ã®é–¢é€£è¨˜äº‹ã‚’åˆ©ç”¨

- [openBD ã® API ã§ ISBN ã‚’ã‚­ãƒ¼ã«æ›¸èªŒæƒ…å ±ã‚’å–å¾—ã™ã‚‹ ( jQuery ä½¿ç”¨ )](https://qiita.com/slangsoft/items/c62023d227a9a9f43f8c)
- [openBDã‚’ä½¿ç”¨ã—ã¦æœ¬ã®æƒ…å ±ã‚’è¡¨ç¤ºã•ã›ã¦ã¿ã‚‹](https://qiita.com/sekkenn1102/items/ae66b3aad3245344f46a)

ä½¿ã„æ–¹ã¯ã€**ã€Œæ‰€å®šã®URLã«ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ISBNã‚’å«ã‚ã¦HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æŠ•ã’ã‚‹ã€**ã€ã“ã‚Œã ã‘ã§ã™ã€‚

``` shell
curl https://api.openbd.jp/v1/get?isbn=[ISBN]
```

ã€Œé¬¼æ»…ç¬¬1å·»ï¼š978-4088807232ã€
ã“ã‚Œã‚’è©¦ã—ã«æŠ•ã’ã¦ã¿ã¾ã™ã€‚

```
curl https://api.openbd.jp/v1/get?isbn=978-4088807232
```

ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ã“ã¡ã‚‰ã€‚
(ISBNã®ãƒã‚¤ãƒ•ãƒ³ã¯æ°—ã«ã—ãªãã¦ã‚ˆã„ã¿ãŸã„)
``` shell
[
  {
    "onix": {
      "CollateralDetail": {
        "TextContent": [
          {
            "TextType": "04",
            "ContentAudience": "00",
            "Text": "æ®‹é…·"
          }
        ]
      },
      "RecordReference": "9784088807232",
      "NotificationType": "03",
      "ProductIdentifier": {
        "ProductIDType": "15",
        "IDValue": "9784088807232"
      },
      "DescriptiveDetail": {
        "TitleDetail": {
          "TitleType": "01",
          "TitleElement": {
            "TitleElementLevel": "01",
            "TitleText": {
              "collationkey": "ã‚­ãƒ¡ãƒ„ ãƒ ãƒ¤ã‚¤ãƒ",
              "content": "é¬¼æ»…ã®åˆƒ 1"
            }
          }
        },
        "Contributor": [
          {
            "SequenceNumber": "1",
            "ContributorRole": [],
            "PersonName": {
              "content": "å¾å³ , å‘¼ä¸–æ™´",
              "collationkey": "ã‚´ãƒˆã‚¦ã‚², ã‚³ãƒ¨ãƒãƒ«"
            }
          }
        ],
        "Collection": {
          "CollectionType": "10",
          "TitleDetail": {
            "TitleType": "01",
            "TitleElement": [
              {
                "TitleElementLevel": "02",
                "PartNumber": "",
                "TitleText": {
                  "collationkey": "",
                  "content": "ã‚¸ãƒ£ãƒ³ãƒ—ã‚³ãƒŸãƒƒã‚¯ã‚¹"
                }
              }
            ]
          }
        }
      },
      "PublishingDetail": {
        "Imprint": {
          "ImprintName": "é›†è‹±ç¤¾"
        },
        "PublishingDate": [
          {
            "PublishingDateRole": "11",
            "Date": "201606"
          }
        ]
      },
      "ProductSupply": {
        "SupplyDetail": {
          "ProductAvailability": "99",
          "Price": [
            {
              "PriceType": "01",
              "CurrencyCode": "JPY",
              "PriceAmount": "400"
            }
          ]
        }
      }
    },
    "hanmoto": {
      "datemodified": "2016-06-01 16:02:24",
      "datecreated": "2016-04-26 16:02:17",
      "reviews": [
        {
          "post_user": "genkina",
          "reviewer": "",
          "source_id": 7,
          "kubun_id": 1,
          "source": "ç”£ç¶“æ–°è",
          "choyukan": "æœåˆŠ",
          "han": "",
          "link": "",
          "appearance": "2019-12-29",
          "gou": ""
        }
      ]
    },
    "summary": {
      "isbn": "9784088807232",
      "title": "é¬¼æ»…ã®åˆƒ 1",
      "volume": "",
      "series": "ã‚¸ãƒ£ãƒ³ãƒ—ã‚³ãƒŸãƒƒã‚¯ã‚¹",
      "publisher": "é›†è‹±ç¤¾",
      "pubdate": "201606",
      "cover": "",
      "author": "å¾å³ ,å‘¼ä¸–æ™´"
    }
  }
]
```

è¤‡æ•°å–å¾—ã—ãŸã„å ´åˆã€ã‚³ãƒ³ãƒåŒºåˆ‡ã‚Šã§æŠ•ã’ã‚‹ã€‚

```
curl https://api.openbd.jp/v1/get?isbn=978-4088-807-232,978-4088815169
```

## å®Ÿéš›ã«ä½¿ã£ãŸã‚³ãƒ¼ãƒ‰

ä½¿ã„æ…£ã‚Œã¦ã„ã‚‹JavaScript (Pythonã˜ã‚ƒãªãã¦ã™ã¿ã¾ã›ã‚“) ã§å®Ÿè£…ã€‚
é¢å€’ã ã£ãŸã®ã§GPT-5ã«æ›¸ã‹ã›ã¦ã„ã¾ã™ã€‚ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¦ãªã„ã§ã™ã€‚

æ©Ÿèƒ½ï¼š
1. å…ƒãƒ‡ãƒ¼ã‚¿ã®CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ISBNã‚’å–å¾—ã—ã€100ä»¶ã”ã¨HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ
	- å®Ÿè¡Œãƒ­ã‚°ã‚’ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ã«å‡ºåŠ›ã—ã¦ãŠã
2. 5,000ä»¶ã”ã¨ã«JSONãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜
	- ä¸€æ—¦ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦é¿é›£ã•ã›ãŸã‹ã£ãŸ
3. ã™ã¹ã¦æ¤œç´¢ã—çµ‚ã‚ã‚‹ã¾ã§1, 2ã‚’ç¹°ã‚Šè¿”ã™

``` JavaScript
import fs from "fs";
import fetch from "node-fetch";
import csv from "csv-parser";

// === è¨­å®š ===

const INPUT_CSV = "./data/unique_isbn_list.";
const OUTPUT_JSON = "./data/openbd_responses.json"; // JSONå‡ºåŠ›
const LOG_FILE = "./data/progress_openbd.log"; // ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«
const BATCH_SIZE = 100; // 1ãƒªã‚¯ã‚¨ã‚¹ãƒˆæœ€å¤§100ä»¶
const SAVE_INTERVAL = 5000; // 5,000ä»¶ã”ã¨ã«ä¸­é–“ä¿å­˜
const RETRY_LIMIT = 3; // ãƒªãƒˆãƒ©ã‚¤å›æ•°

// === ãƒ­ã‚°è¿½è¨˜ ===

function writeLog(message) {
Â  const timestamp = new Date().toISOString();
Â  const line = `[${timestamp}] ${message}\n`;
Â  fs.appendFileSync(LOG_FILE, line, "utf8");
}

// === ãƒªãƒˆãƒ©ã‚¤ä»˜ãfetch ===
async function fetchWithRetry(url, retries = RETRY_LIMIT) {
Â  for (let i = 0; i < retries; i++) {
Â  Â  try {
Â  Â  Â  const res = await fetch(url);
Â  Â  Â  return await res.json();
Â  Â  } catch (e) {
Â  Â  Â  if (i === retries - 1) throw e;
Â  Â  Â  writeLog(`âš ï¸ Retry ${i + 1}/${retries}: ${e.message}`);
Â  Â  Â  await new Promise((r) => setTimeout(r, 500 * (i + 1))); // ãƒãƒƒã‚¯ã‚ªãƒ•
Â  Â  }
Â  }
}

async function main() {
Â  const results = [];
Â  const isbns = [];

Â  // ãƒ­ã‚°åˆæœŸåŒ–
Â  fs.writeFileSync(LOG_FILE, "=== OpenBD API Fetch Log ===\n", "utf8");
Â  console.log("ğŸ“– CSVèª­ã¿è¾¼ã¿ä¸­...");
Â  writeLog("CSVèª­ã¿è¾¼ã¿é–‹å§‹");

Â  // === CSVèª­ã¿è¾¼ã¿ ===
Â  await new Promise((resolve) => {
Â  Â  fs.createReadStream(INPUT_CSV)
Â  Â  Â  .pipe(csv({ mapHeaders: ({ header }) => header.replace(/^\uFEFF/, "") }))
Â  Â  Â  .on("data", (row) => {
Â  Â  Â  Â  const isbn = row.ISBN?.replace(/-/g, "").trim();
Â  Â  Â  Â  if (isbn) isbns.push(isbn);
Â  Â  Â  })
Â  Â  Â  .on("end", () => resolve());
Â  });

  

Â  console.log(`âœ… ISBN ${isbns.length} ä»¶ èª­ã¿è¾¼ã¿å®Œäº†`);
Â  writeLog(`ISBN ${isbns.length} ä»¶ èª­ã¿è¾¼ã¿å®Œäº†`);
Â  console.log("ğŸ” OpenBD API ã«å•ã„åˆã‚ã›é–‹å§‹...");
Â  writeLog("å•ã„åˆã‚ã›é–‹å§‹");

Â  // === ãƒãƒƒãƒå‡¦ç† ===
Â  for (let i = 0; i < isbns.length; i += BATCH_SIZE) {
Â  Â  const chunk = isbns.slice(i, i + BATCH_SIZE);
Â  Â  const url = `https://api.openbd.jp/v1/get?isbn=${chunk.join(",")}`;
Â  Â  
Â  Â  try {
Â  Â  Â  const json = await fetchWithRetry(url);
Â  Â  Â  
Â  Â  Â  for (let j = 0; j < chunk.length; j++) {
Â  Â  Â  Â  const isbn = chunk[j];
Â  Â  Â  Â  const data = json?.[j];

Â  Â  Â  Â  if (data) {
Â  Â  Â  Â  Â  const title = data.summary?.title || "(ã‚¿ã‚¤ãƒˆãƒ«ãªã—)";
Â  Â  Â  Â  Â  const author = data.summary?.author || "(è‘—è€…ä¸æ˜)";
Â  Â  Â  Â  Â  const publisher = data.summary?.publisher || "(å‡ºç‰ˆç¤¾ä¸æ˜)";
Â  Â  Â  Â  Â  const pubdate = data.summary?.pubdate || "";
Â  Â  Â  Â  Â  const logMsg = `ğŸ“— ${i + j + 1}/${isbns.length} title: ${title}`;

Â  Â  Â  Â  Â  console.log(logMsg);
Â  Â  Â  Â  Â  writeLog(logMsg);
Â  Â  Â  Â  Â  results.push({
Â  Â  Â  Â  Â  Â  isbn,
Â  Â  Â  Â  Â  Â  title,
Â  Â  Â  Â  Â  Â  author,
Â  Â  Â  Â  Â  Â  publisher,
Â  Â  Â  Â  Â  Â  pubdate,
Â  Â  Â  Â  Â  Â  response: data,
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  const warnMsg = `âš ï¸ ISBN ${isbn}: ãƒ‡ãƒ¼ã‚¿ãªã—`;
Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  console.warn(warnMsg);
Â  Â  Â  Â  Â  writeLog(warnMsg);
Â  Â  Â  Â  Â  results.push({ isbn, response: null });
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  } catch (e) {
Â  Â  Â  const errMsg = `âŒ Error on batch starting ${i}: ${e.message}`;

Â  Â  Â  console.error(errMsg);
Â  Â  Â  writeLog(errMsg);

Â  Â  Â  chunk.forEach((isbn) =>
Â  Â  Â  Â  results.push({ isbn, response: { error: e.message } })
Â  Â  Â  );
Â  Â  }

  

Â  Â  // === å®šæœŸçš„ã«é€”ä¸­ä¿å­˜ ===
Â  Â  if (
Â  Â  Â  (i + BATCH_SIZE) % SAVE_INTERVAL === 0 ||
Â  Â  Â  i + BATCH_SIZE >= isbns.length
Â  Â  ) {
Â  Â  Â  fs.writeFileSync(OUTPUT_JSON, JSON.stringify(results, null, 2), "utf8");
Â  Â  Â  const saveMsg = `ğŸ’¾ ${i + BATCH_SIZE}/${isbns.length} ä»¶ã¾ã§ä¿å­˜`;

Â  Â  Â  console.log(saveMsg);
Â  Â  Â  writeLog(saveMsg);
Â  Â  }
Â  }

Â  console.log("ğŸ‰ å®Œäº†! å‡ºåŠ›:", OUTPUT_JSON);
Â  writeLog(`å®Œäº†: å‡ºåŠ› ${OUTPUT_JSON}`);
}

main();
```


