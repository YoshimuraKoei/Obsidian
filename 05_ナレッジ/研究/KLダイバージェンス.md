---
title: "【基礎から理解しよう】KLダイバージェンスの意味｜DXコンサルの日進月歩奮闘記"
source: "https://dx-consultant-fast-evolving.com/the-meaning-of-kl-divergence/"
author:
  - "[[keikesu]]"
published: 2021-12-05
created: 2025-11-03
description: "KLダイバージェンスの意味を情報量やシャノンエントロピーを交えつつ、解説しています。"
tags:
  - "clippings"
  - "kl-divergence"
---
![](https://dx-consultant-fast-evolving.com/wp-content/uploads/2021/12/etienne-girardet-ZBqdHL7Yycc-unsplash-1280x720.jpg)

今回は機械学習で登場するKLダイバージェンス（カルバック・ライブラー情報量）の意味について解説してみたいと思います。先に結論だけ書いておくと、KLダイバージェンスは次のような数式で記述されます。

機械学習ではある程度の数学の理解が必須ですが、このKLダイバージェンスはその中でも分かりづらい概念だと思います。なぜなら、微積分・確率・線形代数などは基礎を高校数学で勉強するためとっつき易い一方で、KLダイバージェンスが登場する情報理論は馴染みがないことが多いからです。私自身も初めて見た時はよく意味が分からず苦労したので、ここでは少しでも概念的に分かりやすくなるよう説明したいと思います!!

[【給付金で70%OFF】AI・データサイエンスの全コンテンツが期間無制限で見放題のキカガク長期コースの無料WEB説明会](https://af.moshimo.com/af/c/click?a_id=3764098&p_id=3506&pc_id=8455&pl_id=49630&url=https%3A%2F%2Fwww.kikagaku.ai%2Fcampaign%2F%3Futm_source%3Dafm)

## まずは「情報量」の理解をしよう

KLダイバージェンスの話に入る前に、まずは「情報量」というものを理解していきます。

情報量というのは、言葉で言えば「ある情報を知った時にどのくらいインパクトがあるか」を表す指標です。意味としては以上なのですが、これを何とか数式を用いて表現してみたいと思います。

例えば、合格率10%の試験があるとします。この試験で「A君が合格した」という情報と「A君が落第した」という情報のどちらがインパクトが大きいと感じますか？直感的に前者の方が情報としてインパクトがありそうですよね。なぜなら、合格率10%の試験においては合格する方が稀なので、合格の方がレア情報になるからです。ここから言えることは、 **確率の小さい事象の方が情報量は大きくなる** ということです。つまり、 数式で言えば情報量は確率の逆数を含む のが妥当そうですね。

また別の例として、「A君が倍率1000倍の抽選に当たった」という情報を得たとしましょう。これは「A君が試験に合格した」という情報とは全く独立なので、これら2つの情報から得られる情報量は足し算になると考えるのが妥当そうです。一方で、先ほど「確率」を持ち出しましたが、確率においては独立な2つの事象が起きた時の確率はそれぞれの事象の確率の掛け算になります。つまり、 掛け算であったものを足し算で表現する 必要があるということになるので、 **対数を使って表す** のがよさそうです。

ここまでで述べたことを数式にしてみましょう。確率変数（例えばサイコロの目など）がである確率をとすれば、情報量は次のように表すことができます。

情報量 )

例えば、上記の試験で言うと、合格率は10%なので、「A君が合格した」の情報量はとなります。一方で、「A君が落第した」はなので、前者の方が確かに大きいですね。また、もう1つの例である 「A君が倍率1000倍の抽選に当たった」 と「A君が合格した」は独立の事象なので、同時に起こる確率は、それぞれの確率の積で計算可能です。それを情報量に当てはめてみると・・・

情報量

という計算になるので、情報量においては独立な事象は和として扱われることがご理解いただけるかと思います。

ちなみに、情報量を表す際には 単位はbit を使用します。

さて、ここまででKLダイバージェンスの前提になる「情報量」を定義しましたので、次は一歩進んで「シャノンエントロピー」について説明しようと思います。

## 確率変数そのものの情報量を表すシャノンエントロピー

さて、先ほどは試験に合格した場合の情報量は○○、試験に落第した場合の情報量は△△というような計算を行ないました。それでは、そもそも「（結果に依らず）試験を受ける」という行為の情報量はどう考えられるでしょうか？

これに答えるのが **シャノンエントロピー** です。シャノンエントロピーは 情報量の期待値 として定義されるので、次のような数式で表現することができます。

シャノンエントロピー

期待値なので、確率と情報量を掛け合わせてxが取りうる値の全範囲に対して積分を行なうということですね。直感的には「確率事象（サイコロを振るなど）において平均的にどのくらいの情報量が得られるのか」を表す指標と思ってもらえばよいと思います。さらに理解を深めるために、次のような例でシャノンエントロピーを計算してみましょう。

おみくじ

p(大吉）=, p(中吉）= , p（小吉）= , p(凶) =

定義に従って情報量を計算すると次のようになります。

シャノンエントロピー

ここまでで、シャノンエントロピーの意味や計算はご理解いただけたと思います。ではもう一歩踏み込んで、なぜエントロピーと呼ばれるのかを考えてみましょう（シャノンは人名です）。

エントロピーとはもともと熱力学の用語で「乱雑さ」や「ランダム性」を表す指標です。異分野の話なので、ここでは詳細は割愛しますが、このエントロピーはよりランダムな分布（偏りがなく均一な分布）になっている方が大きくなるという性質を持っています。

それでは、果たしてシャノンエントロピーも同様なのでしょうか？先ほどのおみくじの例で全ての事象の確率を均一（つまり全て確率は）にして、シャノンエントロピーを再計算してみましょう。

シャノンエントロピー

確率分布のランダム性を大きく（より均一に）したら、シャノンエントロピーも大きくなりましたね。つまり、熱力学のエントロピーと似たような性質を持っていることから、シャノンエントロピーと呼ばれているわけですね。

## KLダイバージェンスの本質を掴もう

さて、ここまで確率変数としておみくじなど非常に単純な例を扱ってきましたが、実際の世界では必ずしも話はそう簡単ではありません。そのように **確率分布が非常に複雑な場合には、をよく知っている分布（例えば正規分布など）で近似して考えよう、といったアプローチが取られます。ただ、その際には必然的に「はちゃんとを近似できているのか？」という疑問が湧いてくると思います。** そんな疑問に答えてくれるのがこれから話すKLダイバージェンスなのです。

さて、先ほど学んだシャノンエントロピーの一部をで置き換えてみます。

\-

これは **交差エントロピー** と呼ばれますが、これともともとののエントロピーの差分を計算することで、「とがどれだけ近しいか？」を見ることができるのです。そしてこの差分を表す量こそがKLダイバージェンスなのです。

数式を見れば分かるように、仮にとが全く同じものであれば、（真数がとなるため）KLダイバージェンスはゼロになります。一方で、とが全く異なる分布であれば、KLダイバージェンスはどんどん大きくなっていきます。

以上のように、 KLダイバージェンスは2つの確率分布の類似度合いを評価するための指標として利用価値があるのです。

## KLダイバージェンスの活用事例

少し複雑な話になるかもしれませんが、最後にKLダイバージェンスの活用事例を紹介します。

近年流行りの画像生成技術としてオートエンコーダーと呼ばれるものがあります。その技術を使って、次のような手書き数字の画像を生成したいとします。

![手書き文字のサンプル](https://dx-consultant-fast-evolving.com/wp-content/uploads/2021/12/image.png)

手書き文字のサンプル

手書き数字を生成するためには、既存の画像から潜在的な特徴（変数）を掴んで、その変数たちを活用して新たな画像を生成することになります。例えば、上記の画像はもともと28 x 28の画像ですが、仮にこれらの画像の潜在的な変数はとの2つであると分かったとしましょう。いろいろな数字の画像を自由に作り出すためには、「4であればとはこのくらいの値の範囲に分布している。また5であれば とはこのくらいの値の範囲に分布している」のように、各数値を表すようなとの分布を知る必要があります。

ただし、この厳密な分布を把握するのはほとんど不可能であるため、実際には正規分布で近似することを試みます。正規分布のパラメータ（平均値と標準偏差）をいろいろ変えながら、何とか現実の潜在変数と近い分布になるように合わせ込みを行なうのです。

この時に **「どのくらい正規分布が真の潜在変数の分布に近しいか？」を評価するのにKLダイバージェンスが使われます。さらに言えば、KLダイバージェンスの値が小さくなるように、パラメータが調整されていくことになるのです。**

## まとめ

随分長くなってしまいましたが、KLダイバージェンスをご理解いただけたでしょうか？

最初にも述べたように、私も始めは馴染みが薄く苦労したのですが、徐々に慣れていくと思います。

### 本格的にデータサイエンスを学ぶならキカガク長期コース

本記事では、基礎的な内容について解説を行ないましたが、より本格的にデータサイエンスを学んでみたいという方には [キカガク長期コース](https://af.moshimo.com/af/c/click?a_id=3764098&p_id=3506&pc_id=8455&pl_id=49630&url=https%3A%2F%2Fwww.kikagaku.ai%2Fcampaign%2F%3Futm_source%3Dafm) の受講をお薦めします。

興味はあるけど、いきなり受講を申し込むには抵抗があるという方は、 [キカガク長期コースの無料オンライン説明会](https://af.moshimo.com/af/c/click?a_id=3764098&p_id=3506&pc_id=8455&pl_id=49630&url=https%3A%2F%2Fwww.kikagaku.ai%2Fcampaign%2F%3Futm_source%3Dafm) も是非活用してみてください!

ABOUT ME

![](https://secure.gravatar.com/avatar/f6e8187b6ba064dad954283fa67000c054b4b3a5afffcdb2f58b9b4745f2909b?s=100&d=mm&r=g)

keikesu

電気機メーカーのエンジニア、オフィス・工場向けIOTシステムエンジニアを経て、現在は大手のコンサルティングファームに在籍し、様々な組織のDXを支援するITコンサルタントをしています。 JDLA G検定・E資格を取得しているので、このブログではディープラーニング（主に資格試験関連）の基礎的な内容を投稿しています。

BLOG： [https://dx-consultant-fast-evolving.com/](https://dx-consultant-fast-evolving.com/)

RELATED POST

[![](https://dx-consultant-fast-evolving.com/wp-content/uploads/2022/01/knowledge-g4b1f06f0b_1920-640x360.jpg)](https://dx-consultant-fast-evolving.com/the-basis-of-aic/)

【イメージを使って説明します】情報量の考え方について具体例を使って解説

ディープラーニングG検定keikesu

DXコンサルの日進月歩奮闘記

[View original](https://dx-consultant-fast-evolving.com/the-basis-of-aic/)

[![](https://dx-consultant-fast-evolving.com/wp-content/uploads/2022/01/scott-taylor-02a4DSekRVg-unsplash-640x360.jpg)](https://dx-consultant-fast-evolving.com/the-basis-of-roc-curve-and-auc/)

【細かく説明します】ROC曲線とAUCの概要をわかりやすく解説

ディープラーニングE資格keikesu

DXコンサルの日進月歩奮闘記

[View original](https://dx-consultant-fast-evolving.com/the-basis-of-roc-curve-and-auc/)

[![](https://dx-consultant-fast-evolving.com/wp-content/uploads/2022/08/dragonfly-ave-pTZJTasRzY0-unsplash-640x360.jpg)](https://dx-consultant-fast-evolving.com/common-key-and-public-key/)

【違いを理解しよう】共通鍵暗号方式と公開鍵暗号方式を分かりやすく解説

応用情報技術者試験keikesu

DXコンサルの日進月歩奮闘記

[View original](https://dx-consultant-fast-evolving.com/common-key-and-public-key/)

[![](https://dx-consultant-fast-evolving.com/wp-content/uploads/2021/11/amy-hirschi-JaoVGh5aJ3E-unsplash-320x180.jpg)](https://dx-consultant-fast-evolving.com/%e3%82%b7%e3%82%b9%e3%83%86%e3%83%a0%e9%96%8b%e7%99%ba%e3%81%ae%e8%a6%81%e4%bb%b6%e5%ae%9a%e7%be%a9%e3%81%af%e3%81%a9%e3%81%86%e3%82%84%e3%82%8b%ef%bc%9f%e3%80%90%e6%a9%9f%e8%83%bd%e8%a6%81%e4%bb%b6/ "システム開発の要件定義はどうやる？【機能要件編】")

[システム開発の要件定義はどうやる？【機能要件編】](https://dx-consultant-fast-evolving.com/%e3%82%b7%e3%82%b9%e3%83%86%e3%83%a0%e9%96%8b%e7%99%ba%e3%81%ae%e8%a6%81%e4%bb%b6%e5%ae%9a%e7%be%a9%e3%81%af%e3%81%a9%e3%81%86%e3%82%84%e3%82%8b%ef%bc%9f%e3%80%90%e6%a9%9f%e8%83%bd%e8%a6%81%e4%bb%b6/ "システム開発の要件定義はどうやる？【機能要件編】")

[

【丁寧に解説します】特異値分解の計算方法

![](https://dx-consultant-fast-evolving.com/wp-content/uploads/2021/12/calculator-g59cde6d06_1920-320x180.jpg)](https://dx-consultant-fast-evolving.com/the-calculation-method-of-singular-value-decomposition/ "【丁寧に解説します】特異値分解の計算方法")