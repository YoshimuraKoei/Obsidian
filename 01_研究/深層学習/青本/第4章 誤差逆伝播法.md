---
title:
AI: "false"
published:
created: " 2025-11-06"
description:
tags:
  - permanent-note
  - knowledge
---

# Chapter 4

## 4.1 勾配計算の煩わしさ


## 4.2 誤差逆伝播法

https://zenn.dev/yuto_mo/articles/b56e1fc2215c8b

$$
	\frac{\partial E_n}{\partial w_{ji}^{(l)}} = \frac{\partial E_n}{\partial u_{j}^{(l)}} \frac{\partial u_l^{(l)}}{\partial w_{ji}^{(l)}}
$$
$$
	\frac{\partial E_n}{\partial u_j^{(l)}} = \sum_{k} \frac{\partial E_n}{\partial u_k^{(l+1)}} \frac{\partial u_k^{(l+1)}}{\partial u_j^{(l)}}
$$
$$
	\delta_j^{(l)} \equiv \frac{\partial E_n}{\partial u_j^{(l)}}
$$
$$
	\delta_j^{(l)} = \sum_{k} \delta_k^{(l+1)} (w_{kj}^{(l+1)} f'(u_j^{(l)}))
$$

したがって、**上位の $l+1$ 層のユニットのデルタが与えられれば、 $l$ 層のデルタは計算できる**ということ。(デルタは各層 $l$ の各ユニット $j$ に対して定義されることに注意)
つまり、最初に出力層の各ユニットのデルタが求まっていれば、任意の層のデルタが求まるということ。
このとき、デルタは出力層から入力層の向き、つまり順伝播と逆の向きに伝播される。これが誤差逆伝播法の名前の由来。

よって、目的の微分は

$$
	\frac{\partial E_n}{\partial w_{ji}^{(l)}} = \sigma_j^{(l)} z_i^{(l-1)}
$$
のように表される。
すなわち、第 $l-1$ 層のユニット $i$ と第 $l$ 層のユニット $j$ をつなぐ結合重み $w_{ji}^{(l)}$ に関する微分は、ユニット $j$ 
