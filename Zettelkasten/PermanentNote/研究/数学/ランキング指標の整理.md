---
title: "レコメンド指標の整理: Recall@k・MRR・MAP・nDCG"
AI: "false"
published: 2025-07-14
description: 
tags:
  - permanent-note
  - recommend
  - index
  - math
---
https://zenn.dev/hellorusk/articles/7e336fd3c6be20a8f8d1
---


> [!NOTE] Recall@K
> 各クエリに対して、上位$k$個の予測に含まれる正解数が、総正解数のうちどの程度の割合含まれているかを計算する。そして最後にクエリ全体で平均を取る。


> [!NOTE] MRR (Mean Reciprocal Rank)
> 各クエリ$i$の予測を上から見たときに最初に正解が出てきたときの順位を$rank_i$とする。それに対して、以下のような式を計算する。
> $$
> 	MRR = \frac{1}{|Q|}\sum_{i=1}^{|Q|}\frac{1}{rank_i}
> $$
> なお、予測に正解が1つも含まれない場合は$\frac{1}{rank_i} = 0$とする。**クエリに対して繰り返して平均を取っており、最初に正解が出てきたときの順位が低いほど、スコアが大きくなる。**


> [!NOTE] MAP (Mean Average Precision)
> まず、Average Precisionについて説明。これは$y_j$を$i$番目のクエリの予測について、上から$j$番目の予測が正解であれば1、そうでなければ0の変数として、
> $$
> 	AP_i = \frac{1}{GTP}\sum_{j=1}^k P@j \cdot y_j
> $$
> と書ける。なお、$P@j$は上から$j$番目までの予測におけるPrecisionの値、$GTP$は総正解数。このAverage Precisionを各クエリ$i$に対して計算し、最後にその平均としてMAPを得る。
> $$
> 	MAP = \frac{1}{|Q|}\sum_{i=1}^{|Q|} AP_i
> $$


> [!NOTE] nDCG
> 追加予定
