---
title: 推薦システムについて/プロジェクト/UI/UX
AI: "false"
published: 
description: 
tags:
  - permanent-note
  - recommend
  - oreilly
---
---
[[oreilly-978-4-87311-966-3e 2.pdf]]
この本で紹介されているコードは、オンラインで参照できる。
→ https://github.com/oreilly-japan/RecommenderSystems
Zenn
→ https://zenn.dev/tanukinet/articles/e84a0056fa4349

推薦システムの定義
→ **複数の候補から価値あるものを選び出し、意思決定を支援するシステム**

アルゴリズムによっては、計算は速いが予測精度がよくなかったり、データが大量にある場合にのみ予測精度が良かったりするものがあって、長所短所がさまざま。
→ **ビジネスの目的に応じて、アルゴリズムを適切に選んで使うことが重要**

2007年に The ACM Conference on Recommender Systems(RecSys)という推薦システムの国際会議が初めて開催された。

TwitterやNetflix、Amazon、Appleなどの企業では、推薦システムエンジニアという推薦システムに特化したエンジニアの採用を行っている。日本でも、推薦システムエンジニアの求人が増えている。

コンテンツ情報に比べてインタラクションデータのほうが、リアルタイムにアップデートされていくため、協調フィルタリングの方が、ユーザーの嗜好を反映したクリックや購入がされやすい推薦になる傾向がある。
→ 一方、新規ユーザーや新規アイテムに対しては、行動履歴のデータがないため、コンテンツ情報を用いた内容ベースフィルタリングで推薦することが多い。

## 推薦システムの種類

1. インプット：データの入力
	- ユーザー、アイテムのコンテンツ情報
	- ユーザーとアイテムのインタラクション情報
2. プロセス：推薦の計算
	- 概要推薦計算
	- 関連アイテム計算
	- パーソナライズ計算
3. アウトプット：推薦の提示
	- トップページに表示
	- 商品購入後にメール
	- 郵送でクーポン券

### 概要推薦

Amazonの売れ筋ランキングのように、新着順、価格が安い順、人気度順などの全ユーザーに対して同じ内容を提示するもの。ニュースサイトのようにアイテムの入れ替わりが激しい場合に友好的だが、アイテムに流動性がない場合は常に同じようなアイテムが人気度や新着に表示されるので、あまり効果的ではない。

### 関連アイテム推薦

「このアイテムをチェックしている人はこちらのアイテムもチェックしています」というもの。サイト内でのユーザーの回遊を増加し、欲しいアイテムに出会いやすくなる。
アイテムの類似度に関しても、似たようなアイテムを類似性が高いと捉えるのか、**一緒に購入されやすいアイテムを類似性が高いと捉えるのか**という観点がある。

ハリーポッター問題
→ とある時期に多くの人がハリーポッターの書籍を他のアイテムと一緒に購入していたため、関連アイテム推薦でどのアイテムに対してもハリーポッターが似たアイテムとして常に推薦されてしまった。つまり、**人気アイテムの影響を取り除く必要がある場合がある。**

### パーソナライズ推薦

コンテンツベースでオススメする場合は、ユーザーの年齢や住所などのプロフィール情報をもとに、それに合うアイテム群を計算する。
ユーザーとアイテムのインタラクションデータをもとにおすすめする場合は、協調フィルタリングなどの手法を使い、ユーザーの過去の行動履歴からおすすめのアイテムを計算する。

一般的に、ユーザーとアイテムのインタラクションを使ったパーソナライズの推薦システムは、ユーザーの興味や嗜好をリアルタイムに反映しており、クリックや購入の予測性能が高い。

## 推薦システム開発に必要な3つのスキル

データサイエンティストに求められる3つのスキルセットとして、
- ビジネス力：課題背景を理解した上で、ビジネス課題を整理し、解決する力
- データサイエンス力：情報処理、人工知能、統計学などの情報科学系の知恵を理解し、使う力
- データエンジニアリング力：データサイエンスを意味のある形に使えるようにし、実装、運用できるようにする力

大企業では、ビジネス部門、データサイエンスチーム、データ基盤チームといった3つのスキルごとにチームや部署が分かれていることがある。

## 推薦システムのプロジェクトの進め方

1. 課題定義
2. 仮説立案
3. データ設計・収集・加工
4. アルゴリズム選定
5. 学習・パラメータチューニング
6. システム実装
7. 評価・改善
主に1, 2, 7をビジネス側が、3, 4, 5, 6, 7をデータサイエンティストやデータエンジニアが担当してプロジェクトを進める。スタートアップ企業など人員が少ない場合は、1人のエンジニアがすべてを担当して開発をする場合もある。

#### 課題定義
**ビジネス上の指標をKPIとして定め**、KPIの目標と現状の差を確認したうえで、現状の自サイトの課題を整理して、適切な打ち手を検討する。
データを用いて分析する定量的な方法と、ユーザーにヒアリングする定性的な方法の両方のアプローチで、現状の課題の解像度を高める。
#### 仮説立案
各課題を解決する方法とそれを実現するためのコストを検討し、費用対効果ROIが高い施策から取り組む。
具体的には、フィルタリングやソートなど、実装コストが低く重要度が高い課題を解決してから、推薦システムに取り掛かるのが効果的。
#### 学習・パラメータチューニング
オフラインで検証する際には、データのバイアスに注意する必要がある。例えば、Amazonの5つ星の評価のデータには、各星の評価値が均等に存在するのではなく、5つ星が多いというバイアスがある。
→ **商品に対して特別な思いがある人が評価をつけやすい傾向がある**
また、検索エンジンの影響を受けるバイアスも存在する。検索の上位に現れるものはクリックされやすく、下位に来るものはクリックされづらい。
#### システム実装
**バッチ推薦**は、1日1回や1週間に1回など決まったタイミングでその時点の情報をもとに推薦リストを更新し、ユーザーに対して提供するもの。
**リアルタイム推薦**は、ユーザーの直近の行動履歴を即時に反映した推薦リストを作るもの。データの同期やリアルタイム演算などの幅広いエンジニアリングの技術が必要になる。

## サービスを利用するユーザーの目的に応じたUI/UX事例

ユーザーの目的は利用するサービスの性質やドメインなどによって多岐にわたるが、J.Herlockerを参考に次の4つの分類に従うとする。
- 適合アイテム発見
- 適合アイテム列挙
- アイテム系列消費
- サービス内回遊
#### 適合アイテム発見
適合アイテム発見(find good items)とは、ユーザーが自身の目的を達成するのに適したアイテムを一つでもいいのでサービス上で発見しようとしている場合のこと。ユーザーの目的が達成されるのに十分な程度のユーザーの好みに適合したアイテムを一つでもいいので確実に発見するのが適合アイテム発見では求められる。具体例は食べログ。
さまざまなユーザーの嗜好に適合するアイテムを表示するために、複数のリストをユーザーに表示したい場合の解決法がいくつかある。例えば、タブで1クリックで簡単に切り替えられるUIにすることである。
Netflix ... 1画面に横長のリストを複数並べている。
Tinder ... 標示されたアイテムを左右にスライドすることで、ユーザーからの直接のFBを得ることができる。
#### 適合アイテム列挙
適合アイテム列挙(find all good items)とは、ユーザーが自身の目的を達成するのに適したアイテムをできるだけすべてサービス上で発見しようとしている場合を指す。
具体的なシチュエーション
- 賃貸物件をじっくり検討したい
	- こだわりの条件を複数入力する
	- 内見した後も再び見るので条件を保存
	- 頻繁な引っ越しのために前回の検索条件から推論してほしい
- 申請したい特許と同等のものがすでに存在するかどうか(特許情報プラットフォームJ-PlatPat)
#### アイテム系列消費
アイテム系列消費とは、閲覧、消費していく中で、推薦されたアイテムの系列全体から価値を享受することを目的とする場合を指す。具体例では、Spotifyのような音楽ストリーミングサービス。ECサイトと異なり、**同じアイテムを何度も推薦することでユーザー体験が向上することがある。**
#### サービス内回遊
サービス内回遊(Just Browsing)とは、ユーザーが利用しているサービス本来の目的を達成するためでなく、ただアイテムを閲覧すること自体を目的としてサービス内を回遊する場合を指す。具体的には、旅行予約サービスやホテル予約サービス。

## サービスの提供者の目的に応じたUI/UX事例

ここではBen SchaferやSwearingenを参考に、推薦システムを活用するサービスの提供者側の代表的なビジネス目的を以下の5つに分類した。
- 新規・低利用頻度ユーザーの定着
- サービスへの信頼性向上
- 利用頻度向上・離脱ユーザーの復帰
- 同時購入 (cross selling)
- 長期的なユーザーのロイヤリティ向上
#### 新規・低利用頻度ユーザーの定着
大部分のユーザーにとってある程度のニーズを満たすことを狙って、しばしば概要推薦が用いられることが多い。特定のユーザーに深く刺さるようなアイテムよりも、たくさんのユーザーにそこそこ刺さるようなアイテムを推薦することが重要になる。
#### サービスへの信頼性向上
ユーザーは、サービスが提供するアイテムや広告はサービス提供者の利益を最優先しているのではないか、と考えるケースがある。このような目的のために、利用者評価が有効な場合がある。サービスを利用する他のユーザーによる推薦のほうが、ユーザーに信用され、受け入れられやすいからである。
しかし、サクラ行為やスパムレビューなどが出現することがあり、このような行為は逆にサービスへの信頼を損ねてしまう。対策として、ユーザーが投稿したレビューを一度サービスの運営側が検閲してから公開するというような仕組みでレビューの質を担保する試みもあるが、これは**サービス側に不都合なレビューが不当に揉み消されているのではないかという疑念を持たれる**こともある。
Netflix ... アカウント作成直後に好みの作品を3つ選ぶことにより、パーソナライズ化している
#### 利用頻度向上・離脱ユーザーの復帰
利用頻度の低いユーザーやすでに離脱してしまったユーザーなど、そもそもサービス内での体験向上が難しいユーザーが存在する。そのようなユーザーに対しては通知サービス(notification services)が有効。通知によって、**メールやプッシュ通知などの方法で推薦をサービス外へ送付する。**
#### クロスセル
クロスセルは、ある商品の購入を検討しているユーザーに対し、別の商品もセットもしくは単体で購入してもらうことで単価を上げる方法の一つ。クロスセルを実現するのに有効な手段として関連アイテム推薦(product-associated recommendations)が挙げられる。
#### 長期的なユーザーのロイヤリティ向上
むやみなパーソナライズ化は精度の悪さからユーザーの離脱を引き起こすので、ユーザーの情報が蓄積された後、ある程度の精度が担保された状態ではじめてパーソナライズ化を行うのが良い。
また、明示的なフィードバックの機能も提供も有用であり、通常は獲得しづらいネガティブなフィードバックを収集することができ、推薦精度の向上を狙うことが出来る。
逆に、高度なパーソナライズ化はユーザー体験を損ねる可能性がある。ユーザーが自分で認識している以上に自身の情報をサービスに取られていると恐怖を感じて不信感を持ったり、推薦技術に対して単純に理解の出来ない気持ちの悪いものだと不快感を持つことがある。これに関しては、プライバシーポリシーやあえて個人化しないようにできる設定などで対応する必要がある。

## 関連トピック

#### アイテムの「類似度」
類似度の定義はさまざま考えられる。たとえば映画を推薦するサービスを考えると、映画のジャンルが似ているものを類似すると考えることもできるし、監督が似ている、公開年度が近いのも似ているかもしれない。アイテム同士の「類似度」は、用いる基準で大きく変わり得る。これはユーザーニーズに応じて設計するべきである。

#### 目新しさ・セレンディピティ・多様性
ユーザーに推薦されるアイテムは、ユーザーが関心があることに加えて、ユーザーにとって分かり切った物ではないという新規性が要求されることがある。このような**目新しさ**は重要な観点の一つ。
目新しさに、思いがけなさや予見の出来なさといった「意外性」の要素を加えたものとして**セレンディピティ(serendipity)** という要素もある。ユーザーに新たに推薦されるものが、既存の好きなものと似ていることを知らなかったときにセレンディピティがあるという。
セレンディピティに必要な「意外性」という、ユーザーの感情的な要素を定量的に測定するのは難しいので、**多様性(diversity)** という観点で定量的に測定することがある。例えば、新規ユーザーにはユーザーに適合するアイテムを推薦するけれども、ヘビーユーザーにはサービスへの飽きを解消するためにセレンディピティのあるアイテム推薦を行う。
#### 推薦アイテムの選別
- 再度購入することがあるかどうかはアイテムによる
- 在庫がない・違法なアイテムなどはユーザーに表示させる前に取り除く
- 何度も表示されたが購入に至っていないアイテムは取り除くべき
#### 推薦理由の提示
推薦システムにおいてアイテムの推薦理由(explanation of recommendations)をユーザーに提示することで、推薦の効果、推薦の透明性、ユーザーの満足度を向上をさせられることが知られている。
