
サーベイ論文から抽出
[[Manipulating Recommender Systems_ A Survey of Poisoning Attacks and Countermeasures.pdf]]

---
###### ポイズニング攻撃の種類

CFレコメンドシステムに対する攻撃

- **古典的なヒューリスティック攻撃**
	- あらかじめ定められたヒューリスティックなルールやアルゴリズムに基づいた攻撃
	- この攻撃自体は学習を伴わない
	- 比較的単純に見えるが効果的
- **AIベースの攻撃**
	- 機械学習モデルを利用して実行される攻撃
	- 例えば敵対的生成ネットワークのようなモデルを用いて既存のユーザーの評価パターンを学習し、より検知されにくいデータを偽装
	- 学習によって進化する点が大きな特徴

---
###### 市況

- **過去7年間でレコメンドシステムに対する攻撃数が増加**
	- Google ScholarやScopusといった主要なコンピュータサイエンスのリポジトリから計量書誌学分析を用いて抽出された、年ごとの攻撃の公開数とカテゴリを一覧にしている
- **古典的な攻撃からAIベースの攻撃への明確な移行が見られる**

![[Pasted image 20250811172341.png]]
(2023年の件数1件しかなくね...？)

---
###### ポイズニング攻撃に関する論文の市況

- 既存の攻撃に関するサーベイ論文は**主に古典的なヒューリスティック攻撃とその対策に焦点を当てている**
- 最近の研究では、ヒューリスティック攻撃とAIベースの攻撃の組み合わせを扱っているものがある
- ポイズニング攻撃について、**レコメンドシステムに特化した調査論文は存在しない**

---
###### ポイズニング攻撃と敵対的攻撃の違い

- **敵対的攻撃**
	- モデル学習後の推薦段階で仕掛けられる
	- 根底にあるモデルを変更することなく、推薦時にレコメンドシステムの出力を不正にできるサンプルを見つけること
	- 入力データを操作することで攻撃中にシステムを一時的に欺く
	- 具体例
		- ログデータの改ざんによる入力値の変更
- **ポイズニング攻撃**
	- モデルのトレーニング段階で仕掛けられる
	- モデルのトレーニングデータを汚染し、攻撃者に有益な結果をもたらす攻撃モデルへと変換させることを目的とする
	- 具体例
		- 悪意のあるログデータの注入による訓練妨害

---
###### サーベイ論文の貢献

- 攻撃者の課題について議論し、レコメンドシステムの攻撃に焦点を当てている
- 古典的なヒューリスティック攻撃とAIベースの攻撃の両方を網羅した初の包括的なレビューを行い、攻撃を5つの次元で分類
- ポイズニング攻撃に対する41の対策について広範なレビューを提示
- この分野における未解決の問題について記述し、将来の研究の方向性を示している
- 新規参入の研究者に向けてプログラムコード、データセットを含む公開リポジトリを構築

---
###### レコメンドシステムの概要

- 行列分解ベース
- グラフベース
- アソシエーションルールベース
- 近傍ベース
- ディープラーニングベース

(LightGBMについて)
**リトリーバル(候補生成)フェーズ → ランキング(LightGBM)フェーズ**

---
###### ポイズニング攻撃の概要

- 一般的な目的
	- 自社の評判を高めるためにアイテムをプロモート
	- 競合他社を攻撃するためにアイテムをデモート
- 分類の一つ
	- model-agnostic
		- 基盤モデルや構築するために使用されるアルゴリズムを無視
		- 通常、攻撃の有効性は限定的
	- model-intrinsic
		- 特定の種類の訓練プロセスに合わせて最適化
		- モデルに重大な損害を与える可能性アリ
- プロファイル汚染攻撃

---
###### レコメンドシステムにおけるポイズニング攻撃の特性

- ポイズニング攻撃はモデルのロバスト性を評価するための事実上の標準手順
- モデルのデータセットに非常に多くのユーザー・アイテムの相関関係を注入する必要がある
- 攻撃者は「ユーザーとしての行動」によりデータを取得するため、通常の攻撃は評価行列のみに基づく必要がある？

---
###### ポイズニング攻撃の面から見たレコメンドシステムの特徴

- **オープン性**
- **コンセプトドリフト**
	- 季節的な好みや流行の傾向によってユーザーの行動が変化
	- 異常検知技術を適用するが、コンセプトドリフトによって誤分類が発生する可能性
- **クラス不均衡なデータ**
	- 偽ユーザーの数は全体のユーザーのごく一部


---
###### ポイズニング攻撃によるリスク

 - eコマース
	 - 偏った推薦、信頼の喪失 → 経済的損失リスク
 - ソーシャルメディアプラットフォーム
	 - 誤情報、二極化、有害なコンテンツのリスク
 - ニュース推薦
	 - 意見操作、民主主義的価値のリスク

---
###### ポイズニング攻撃の分類

![[Pasted image 20250810003255.png]]


---
###### 攻撃者の目標

- 非ターゲット型
	- エラーの最大化により役に立たなくする目的
	- こちらの研究は多くはない
- ターゲット型
	- 特定のターゲットアイテムの人気を増減させる目的
	- プロモーション攻撃 or デモーション攻撃
	- 攻撃のインセンティブが明確なので、研究が多い

---
###### 敵対者の知識

- ブラックボックス攻撃
	- アーキテクチャ、予測関数、パラメータ、相互作用履歴Rを知らない
- グレーボックス攻撃
	- 限定的な知識を持つ
	- ユーザー・アイテム間の相互作用行列Rに悪意のあるデータをインジェクトするのみ
	- 特に重要になる
- ホワイトボックス攻撃
	- 徹底的な知識を持つ
	- 予測関数、パラメータ、相互作用の履歴R

→ 3つの知識仮定は研究ボリュームとして均等に分布

---
###### 攻撃の影響

- システムの可用性(Availability)への影響
	- 主にホワイトボックス攻撃とグレーボックス攻撃が入力データを妨害
	- 研究の3分の2
- 複製(Replication)の試み
	- ブラックボックス攻撃はシステムの可用性を損なう点では効率が劣るため、システムを複製する可能性がある
	- シミュレーションとしてリバースエンジニアリング
	- 研究の3分の1
- 不可知性 Unnoticeability
	- データ特性を維持することでアプローチが気付かれないように

---
###### 攻撃者の能力

- 偽ユーザーの作成
	- 偽ユーザーの最大数である攻撃サイズはシステム全体のユーザー数よりはるかに少ない
	- 上記は予算など運用上の観点から
- 偽評価の作成
	- 注入できる評価の数にはプロファイルサイズと呼ばれる上限kがある
		- 上記は現実のユーザーはシステム内のごく一部のアイテムとしかやり取りしないため
	- 評価の値にも上界と下界がある
		- 実際の評価行列の近傍である必要がある
- 偽の共起作成
	- ターゲットアイテムと関連付けられているユーザーに対して他のアイテムへの訪問を注入
- 偽リンクの追加
	- 知識グラフの脆弱性を突く
- 偽画像の使用
	- 主にコールドスタート問題の対処のための画像認識を悪用

↓
- 偽ユーザー × 偽評価 の研究が大部分
- 偽の共起は一部
- 偽リンク、偽画像はごくわずか

---
###### 攻撃のアプローチ

- インジェクション
	- 限定的な知識しか持たない場合
	- うまく設計された少数のユーザーの注入
	- 研究のすべての手法が何らかの形で偽ユーザーと評価を訓練データに注入している
- シミュレーション
	- ブラックボックスの状況
	- 通常、標的のレコメンドシステムをシミュレートし代替モデルを訓練
	- インジェクションに加えてシミュレーションも行う研究は少数

---
###### ポイズニング攻撃のグループ分け

- モデル非依存攻撃(model-agnostic attacks)
	- あらゆるレコメンドシステムを攻撃
	- 特定のモデルのアルゴリズムに依存しない
- モデル内在攻撃(model-intrinsic attacks)
	- 特定の種類のレコメンドシステムを標的とする攻撃
	- 例えばCFや行列分解

![[Pasted image 20250810144225.png]]

---
###### モデル内在攻撃

- 行列分解ベースに対する攻撃 (Bo Liなど) ← 多い
- グラフべースに対する攻撃 ← そこそこ
- 近隣ベース ← 一つ？
- ディープラーニングベース ← 一つ？
- FDRSベース ← 二つが注目に値するらしい

---
###### ドメイン

- 映画
- POI(Point Of Interest)
	- 観光地
	- 商業施設
	- 公共施設
	- etc
- 位置情報サービス
- 引用ネットワーク
- ニュース
- etc

→ **ポイズニング攻撃の影響は広範囲にわたる。** オンラインデータの完全性と信頼性を守るため、堅牢な対策を開発する必要がある。

---
###### インタラクションの種類

- **明示的なインタラクションの研究が8~9割**
- 暗黙的なインタラクションの研究はわずか

---
###### ポイズニング攻撃の評価指標

![[Pasted image 20250810162603.png]]
- **HR@K (The hit rate ratio)** が最も優勢で、研究の3分の2で採用
- **nDCG@K (Normalized discounted cumulative gain)**が次いで研究の4分の1で採用
- 上記2つの指標以外は一般的ではない

---
###### データセット

- **MovieLens**が研究の3分の2以上で使用される
- **Amazon**の様々な製品カテゴリのデータセットが研究の半分で使用される
- Netflixは3つ
- Yelpは2つ

---
###### ポイズニング攻撃の隆盛

![[Pasted image 20250810163231.png]]

- **近年のAIの進歩により、発表された研究全体の数が大幅に増加**
- 2020年から2023年の期間では、AIベースのポイズニング攻撃がほとんどを占める

---
###### ポイズニング攻撃への対策

- 検知手法
	- 攻撃で作成されたプロファイルを特定することを目的とする
- 防御手法
	- 悪意のあるプロファイルを明示的に特定しようとせず、攻撃に対してよりロバストにすることを目指す

---
###### 検知手法

既存の検知手法は、model-agnosticな特徴量とmodel-intrinsicな特徴量のいずれかに基づく。

- model-agnosticな特徴量 ... 評価行動の絶対的な異常さ
	- RDMA
		- 特定のユーザーが多数の特定のアイテムに与えた評価が他のユーザーの評価と比べてどれだけ平均的に乖離しているか
	- WDMA
		- RDMAの重み付き分散で、疎なアイテムに対するユーザー評価の累積的な違いを捉える
	- 長さ分散(LengthVar)
		- プロファイルの長さの違いを測る指標
	- トップ近隣ユーザーとの類似度(DegSim)
		- あるユーザーがトップk人の近隣ユーザーとどれだけ似ているか
	- 特徴
		- 本物のユーザーが異常な行動を示した場合に弱い
- model-intrinsicな特徴量 ... 攻撃者プロファイル内の評価間の相対的な関係性の歪み
	- 平均分散(MeanVar)
		- 悪意のあるプロファイルを構成する3つの部分に分けて測定。①ターゲットアイテムへの極端な評価②プロファイルを埋めるためのフィラーアイテムへの評価③未評価のアイテム
	- フィラー平均ターゲット差分モデル(FMTS)
		- ターゲットとなる部分の評価とフィラー部分の評価との差の度合いを評価
	- フィラー平均相関(FAC)
		- プロファイル内の評価と全アイテムの平均評価との間の相関を反映
	- フィラー平均差分(FMD)
		- プロファイルの評価と全アイテムの平均評価の絶対差の平均値を測定


---
###### 検知特性

検知特性の基礎的なフレームワーク。

1. ユーザープロファイル
	- 類似性
	- サイズ
	- グループ行動
	- 属性
2. ターゲット評価
	- 集合性
	- 歪んだ評価
3. フィラー評価
	- 評価
	- 長さ
4. サイド情報
	- 共起グラフ
	- ユーザー・ユーザーグラフ

---
###### 検知手法の概要

- 教師あり学習の手法
- 半教師あり学習の手法
- 教師なし学習の手法

---
###### 防御手法

効果的な防御策の一つがロバスト最適化。

- オープン性の課題のアプローチ
	- 外れ値検知
	- データサニタイゼーション
	- 前処理技術
- コンセプトドリフト
	- 動的学習アルゴリズム
- データの不均衡
	- アンサンブル手法

---
###### どの対策がどの攻撃に効果的か

- ユーザーと評価に関する攻撃の研究が多く、それに伴い**ユーザーと評価に関する攻撃に効果的な対策が多い**

![[Pasted image 20250811212736.png]]

---
###### どの対策がどの攻撃に対して弱いか

- 全体として、特定の攻撃に対して弱い対策はごく少数

![[Pasted image 20250811213040.png]]

---
###### ポイズニング攻撃のギャップ、限界、そして今後の方向性

- 攻撃者への知識：ホワイトボックス、グレーボックスからブラックボックス攻撃へ
	- 既存のポイズニング攻撃はホワイトボックスおよびグレーボックス攻撃が多い
	- 通常はプライバシーとセキュリティの懸念からターゲットとなるレコメンドシステムへのアクセスは通常制限される
- 攻撃手法：特定モデル向けからモデルに依存しない攻撃へ
	- 現在は、特定モデルに限定された攻撃が主流だが、これは現実世界にあまり適用できない
- サイド情報の統合
	- 最近ではドメインハイパーグラフ、ソーシャルプロパティ、空間情報など推薦の質を向上させるためにサイド情報を活用するレコメンドシステムが増えている
	- サイド情報は役立つ一方、複雑さと潜在的なセキュリティリスクをもたらす

---
###### 攻撃対策のギャップ、限界、そして今後の方向性

- 攻撃前の検出
	- 攻撃前の振る舞いを検出するアプローチがほとんどない
	- 防御、検出に加えて予測という新しいカテゴリー
- 主要な特性を超える
	- ユーザーの属性のような補足情報を取り入れて検知
- 精度以外も超える
	- 公平性と説明可能性を担保することが同様の攻撃に対する予防策を開発する上で重要
- オーバーヘッドの最適化
	- 検知・防御手法の追加にかかるレコメンドシステムのパフォーマンスへの影響を最小化

---
###### ポイズニング攻撃と対策の関連付け

- 新しいタイプのポイズニング攻撃に関する研究の量は多いが、対策の開発に関する研究は近年あまり進んでいない
	- 悪用される可能性のある様々な脆弱性を抱えており、さらに攻撃を阻止するための効果的な対策が存在しない可能性がある

---
###### レコメンドシステムの一般的な脆弱性の統合

- 一般的な脆弱性がレコメンドシステムに与える影響は整っていない
	- ソフトウェアの脆弱性
		- プログラムのバグと設計ミス
		- ゼロデイ攻撃
		- SQLインジェクション
		- マルウェア感染
	- 運用上の脆弱性
		- 不適切な認証・権限管理
		- 設定不備
		- パッチ適用遅延
		- ヒューマンエラー
	- 物理的な脆弱性
		- 不法侵入
		- 自然災害

---
##### Appendices

下記のレコメンドシステムの理論的な概要が記載されている。

- 行列分解ベースのレコメンドシステム
- グラフベースのレコメンドシステム
- 近隣ベースのレコメンドシステム
- ディープラーニングベースのレコメンドシステム
- Federated Recommender Systems

