---
title: 
AI: "false"
published: 2025-07-18
description: 
tags:
  - permanent-note
---
##### 復習
先週 ... 第1章完結、ナップサック問題

https://drive.google.com/file/d/1kAQXole11d7Nei4PR54nZjIMxa2A13gi/view?usp=drive_link

# 2.3 Cutting Stock: Formulations with Many Variables
Cutting Stock ... 資材切り出し問題

---

## 資材切り出し問題

製紙工場では、幅$W$の**大型ロール**を生産し、それを需要に応じて様々な幅の**小型ロール**に切断します。この問題は、注文された小型ロールを供給するために、何本の大型ロールが必要かを最小化することを目指します。

---
### 問題設定

- **大型ロールの幅**: W
- **異なる小型ロールの幅の種類数**: m
- **小型ロールの幅**: $w_i​ （i=1,…,m)$
    - $w_i​≤W$
- **幅 $w_i$​ の小型ロールの注文数**: $b_i$​

この問題を定式化するにあたり、使用される大型ロールの数には上限 $p$ があると仮定します。

---
### 変数定義
- $y_j$​: 大型ロール $j$ が使用されるかどうかを示す**バイナリ変数**$（j=1,…,p）$    
    - $y_j​=1$ ならば使用される
    - $y_j​=0$ ならば使用されない
- $z_{ij}$​: 大型ロール$j$ から切り出される幅 $w_i$​ の小型ロールの**本数**$（i=1,…,m, j=1,…,p）$
    - $z_{ij}​∈Z+$
---
### 数理モデル（定式化）

この資材切り出し問題は、以下の**整数線形計画問題**として定式化できます。
#### 目的関数

使用する大型ロールの総数を最小化します。

$$
\begin{align}
	\min & \quad \sum_{j=1}^p ​y_j \\
	&\sum_{i=1}^m w_i z_{ij} \leq W_{y_j} \quad j = 1,...,p \\
	&\sum_{j=1}^p z_{ij} \geq b_i \quad i = 1,...,m \\
	& y_j \in \{ 0, 1 \} \quad j = 1,...,p \\
	& z_{ij} \in \mathbb{Z}_+ \quad i = 1,...,m, j = 1,...,p.
\end{align}​
$$
##### 制約条件

1. **幅容量制約**: 各大型ロール j から切り出される小型ロールの幅の合計は、大型ロールの幅 W を超えてはなりません。
2. **需要充足制約**: 各幅 $w_i$​ の小型ロールの生産量が、注文数 $b_i$​ を満たす必要があります。
	- 疑問点①：イコールであればいいんじゃない？(by 小林先生)
	- 疑問点②：この問題は対称性が存在するので、分枝限定法の限定操作がしづらいのでは？(by 小林先生)

これは強力な定式化ではない。それは線形計画緩和によって提供される下限は、最適な整数値からかなり離れているからである。そこで、**可能な限りすべてのカットパターンを考慮してみよう。**

##### カットパターン

これまでの定式化では、線形計画緩和の解が最適整数解から乖離するという課題がありました。これを改善するため、**「切断パターン」**という概念を導入します。

---

###### 1. 切断パターンとは？ ✂️

- **定義**: 大型ロールからどのように小型ロールを切り出すか、その**具体的な組み合わせ**を「切断パターン」と呼びます。
- **表現方法**: 各切断パターンは**ベクトル $s∈\mathbb{Z}^m$** で表現されます。
    - ベクトルの各成分 $i（s_i​）$は、大型ロールから切り出される**幅 wi​ のロールの数**を表す。
###### 2. 切断パターンの集合 S 📐

- **定義**: 考えられるすべての切断パターンの集合を S とします。
- **数学的表現**: S は以下の条件を満たすベクトルの集合です。
$$
	S := \{s \in \mathbb{Z}^m : \sum_{i=1}^m w_i s_i \leq W, s \geq 0\}
$$
    
    - $\sum_{i=1}^m w_i s_i \leq W$: 各小型ロールの幅 (wi​) とその本数 (si​) の積の合計が、大型ロールの幅 (W) を超えてはならないことを意味します。
    - $s≥0$: 切り出すロールの本数が非負である必要があります。
- **特性**: この集合 S は、**ナップサック集合**としても知られています。これは、限られた容量（ナップサックの容量 $W$）の中に、異なる重み（アイテムの重さ $w_i$​）を持つアイテム（小型ロール）を、どのように効率的に詰め込むかを考える問題と類似しています。
---
###### 3. 具体例 📏

仮に、大型ロールの幅 $W=5$ で、注文が以下の3種類の幅のロールであるとします。

- $w_1​=2.1$
- $w_2​=1.8$
- $w_3​=1.5$

この場合の**可能な切断パターン**の例をいくつか見てみましょう。

- **パターン1: 幅 1.5 のロールを3本切り出す**        
    - 合計幅: 0×2.1+0×1.8+3×1.5=4.5≤5
- **パターン2: 幅 2.1 のロールを1本、幅 1.8 のロールを1本切り出す**
    - 合計幅: 1×2.1+1×1.8+0×1.5=3.9≤5

このように、すべての可能な切断パターンを列挙し、それらを基本要素として問題を再構築することで、より効率的な解法に繋がると期待されます。

---

###### 新しい定式化 📊

以前の定式化の課題を解決するため、**切断パターン $s \in S$** を用いた、より強力な整数計画問題として資材切り出し問題を定式化します。

$$
\begin{align}
	\min \quad & \sum_{s \in S} x_s \\
	& \sum_{s \in S} s_i x_s \geq b_i, \quad i = 1,...,m \\
	& x \geq 0 \quad \text{integral}.
\end{align}
$$
- **変数**:
    - $x_s$​: パターン $s \in S$ に従って切り出されるロールの**本数**（整数変数）
- **目的関数**:
    - 使用する大型ロールの総数を最小化します。
- **制約条件**:
    - 各幅 $w_i$​ の小型ロールの需要 $b_i$​ を満たすようにします。

---

###### 定式化の特性と課題 🤔

- この定式化は、**制約行列の列**がすべてナップサック集合 S の**実行可能解**（つまり、可能な切断パターン）となっています。
- **利点**:
    - この定式化は**強力**です。線形計画緩和によって得られる下限は、通常、**整数計画の最適値に非常に近い**ことが、計算経験から示されています。
    - 線形計画解を単純に**丸める**ことで、通常、整数計画の良好な解が得られます。        
- **課題**:
    - しかし、この（パターンベースの）線形計画緩和を解くことは**困難**です。
    - その理由は、考えられる切断パターン（つまり、制約行列の列数）が**非常に膨大**になるためです。

---

###### 解法の鍵: 列生成法 ✨

この課題に対する最善の解決策は、**列生成法 (Column Generation)** を用いることです。
- **提唱者**: Gilmore と Gomory によって最初に提案されました [168]。
- **概要**: 列生成法は、最適化問題を解く際に、**必要となる列（この場合は切断パターン）だけを動的に生成していく手法**です。全てのパターンを事前に列挙する必要がないため、列数が膨大になる問題に適しています。
	- 変数あるいは制約式が極端に多いLPを解くための枠組み
- **今後の学習**: この手法については、本節では簡潔に概要を述べるにとどめ、詳細は後続のセクション 8.2.2 で改めて解説します。
- **注記**: 線形計画法の双対性（セクション 3.3 で議論）に馴染みがない読者は、直接セクション 2.4 に進むことを推奨します。

---

###### 線形計画緩和の双対問題 🔄

資材切り出し問題（定式化 (2.2)）の線形計画緩和（$x_s$​ が整数制約なしの場合）の**双対問題**は、以下のように定式化されます。

$$
\begin{align}
	\max \quad & \sum_{i=1}^m b_i u_i \\
	& \sum_{i=1}^m s_i u_i \leq 1, \quad s \in S \\
	& u \geq 0.
\end{align}
$$

- **双対変数**:
    - $u_i$​: 各幅 $w_i$​ のロールの需要 $b_i$​ に対応する双対変数
- **目的関数**:
    - 需要の合計を最大化します。
- **制約条件**:
    - 各カットパターン $s \in S$ に対して、そのパターンから得られる各小型ロールの価値の合計が1以下である必要があります。        
    - 各カットパターンの数だけ式があります。
    - $u_i​ \geq 0$

---

###### 列生成法のメカニズム ⚙️

列生成法は、この双対問題の性質を利用して、膨大な数のカットパターンを効率的に扱います。

- **部分集合での開始**
	- まず、切断パターン全体の集合 S の**部分集合 $S′$** を考え、その $S′$ に含まれる変数に限定して資材切り出し問題 (2.2) の線形計画緩和を解きます。
- **双対問題の制限**
	- 同様に、双対問題 (2.3) も S′ に含まれるパターンに対応する制約のみを考慮して解きます。
- **最適解の拡張**
	- $S′$ に限定された問題の最適解を $xˉ$ と $uˉ$ とします。$xˉ$ を$S∖S′$ の要素に対応する変数を 0 とすることで、元の問題 (2.2) の線形緩和の実行可能解に拡張できます。
- **強双対性の利用**
	- $xˉ$ が元の問題 (2.2) の線形緩和の最適解であるのは、**強双対性**の原理により、$uˉ$ が元の双対問題 (2.3)（$S$ 全体で定義されたもの）に対して実行可能解を提供する**場合のみ**です。

---
###### 最適性の確認と新しいパターンの生成 ➕

- **実行可能性の条件**
	- $uˉ$ が (2.3) の実行可能解であるのは、**すべての $s \in S$** に対して $\sum_{i=1}^m ​s_i \bar{​u}_i \leq 1$ が成り立つ場合のみです。
- **ナップサック問題の活用**
	- これは、以下の**ナップサック問題**の最適値が 1 以下であることと同義です。
$$
	\max \{ \sum_{i=1}^m ​\bar{u}_i ​s_i ​:s \in S \}
$$
- **新しい列（パターン）の生成**:
    - もし、このナップサック問題の最適値が 1 を**超える**場合、その最適解を s∗ とします。
    - この s∗ は、uˉ によって最も強く制約が**破られている** (most violated) パターンに対応します。
    - この s∗ を S′ に追加し、候補となるパターンの集合を拡大します。
- **列生成の核心**: これが**列生成スキーム**です。この手法では、線形計画問題において、指数関数的に多くの変数が存在する（つまり列が非常に多い）場合に、**強双対性が破られた時**に、最適化問題（ここではナップサック問題）を解くことで、**必要な変数（列）をその場で生成**します。

---
# 2.4 Packing, Covering, Partitioning

訳：充填、被覆、分割

$E = \{ 1, 2, ..., n\}$、$\mathfrak{F} = \{ F_1, F_2, ..., F_m\}$ を考える。

**SがFの充填**
$\Leftrightarrow$ SがFの任意の要素に対して、多くても1つの要素を共有する

**SがFの分割**
$\Leftrightarrow$ SがFの任意の要素に対して、ちょうど1つの要素を共有する

**SがFの被覆**
$\Leftrightarrow$ SがFの任意の要素に対して、少なくとも1つの要素を共有する

分割 $\Rightarrow$ 被覆
分割 $\Rightarrow$ 充填

$$
	x^S \in \{ 0, 1\}^n
$$
$$
\begin{equation}
	x_j^S = 
	\begin{cases}
		1 \quad (j \in S)\\
		0 \quad (otherwise)
	\end{cases}
\end{equation}
$$

$F$の充填$P$
$$
	S^P := \{ x \in \{ 0, 1\}^n : \sum_{j \in F_i} x_j \leq 1, \forall F_i \in \mathfrak{F} \},
$$
$F$の分割$T$
$$
	S^T := \{ x \in \{ 0, 1\}^n : \sum_{j \in F_i} x_j = 1, \forall F_i \in \mathfrak{F} \},
$$
$F$の被覆$C$
$$
	S^C := \{ x \in \{ 0, 1\}^n : \sum_{j \in F_i} x_j \geq 1, \forall F_i \in \mathfrak{F} \},
$$

添え字 $j = 1, ... , n$に対する重みを$w_j$とする。

**集合充填問題**
$$
	\max \sum_{j=1}^n w_j x_j : x \in S^P
$$
**集合分割問題**
$$
	\min \sum_{j=1}^n w_j x_j : x \in S^T
$$
**集合被覆問題**
$$
	\min \sum_{j=1}^n w_j x_j : x \in S^C
$$


> [!NOTE] **定義：Fの接続行列(the incidence matrix)**
> Fの接続行列A
$\Leftrightarrow$ $m \times n - 0, 1$行列$A$ ($a_{ij} = 1(j \in F_i)$の時に限る)

$$
	S^P := \{ x \in \{ 0, 1 \}^n: Ax \leq 1 \}
$$
## 2.4.1 Set Packing and Stable Sets

訳：充填集合と安定集合

無向グラフ $G = (V, E), n := |V|$


> [!NOTE] $G$の安定集合$S$
> $S \subseteq V$
> $S$内のどの2つのノードも互いに隣接していないノード集合

characteristic vector $x$
$$
	x^S \in \{ 0, 1\}^n
$$
$$
\begin{equation}
	x_j^S = 
	\begin{cases}
		1 \quad (j \in S)\\
		0 \quad (otherwise)
	\end{cases}
\end{equation}
$$


> [!NOTE] 安定集合は数式ではこのように定義される
> $$
> \text{stab}(G) := \{ x \in \{ 0, 1 \}^n : x_i + x_j \leq 1 \quad \text{for all } ij \in E \}.
> $$

これによりグラフから集合充填族を形成できた。


> [!NOTE] 定義：Aの交差グラフ(the intersection graph) $G_A = (V, E)$
> ・$n$個のノードを持つ単純無向グラフ
> ・各ノードは$A$の各列に対応($A$は$m \times n$の0-1行列)
