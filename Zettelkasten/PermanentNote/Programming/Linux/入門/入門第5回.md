---
title: Linux講座第5回
AI:
published: 2025-08-31
description:
tags:
  - permanent-note
  - linux
---
**Linux講座**
- https://engineer-ninaritai.com/infraacademy/course-category/linux/?loop_content_only=false&column_per_row=3&course_per_page=12&show_pagination=false&keyword=Linux%E5%85%A5%E9%96%80&tutor-course-filter-category=57&course_order=oldest_first&course_filter=true&loop_content_only=false&column_per_row=3&course_per_page=12&show_pagination=false&current_page=1&action=tutor_course_filter_ajax

---
##### ユーザーの種類

Linuxのユーザーは２種類あります。

- _管理者ユーザー_
- _一般ユーザー_

それぞれの種類について解説します。

###### 管理者ユーザー

**管理者ユーザーとは、Linuxを管理するユーザーのことです。**

管理者ユーザーには、さまざまな権限が付与されています。システムの重要なファイルを編集できたり、システムの設定を変更する権限があります。

Linuxの管理者ユーザーは、**root(ルート)**と呼ばれています。rootユーザー=管理者ユーザーと覚えておきましょう。

![[Pasted image 20250831145709.png]]

ちなみに、Windowsの場合は、Administrator(アドミニストレーター)と呼ばれており、略してAdmin(アドミン)と呼ぶこともあります。

###### 一般ユーザー

**一般ユーザーとは、普段使用するユーザーのことです。root以外のユーザーのことです。**

Linuxを使用する際は、一般ユーザーでログインします。

一般ユーザーは、ファイルの作成や編集、システムの利用などができる一方、**システムの重要な設定はできないようになっています。**

管理者ユーザーと一般ユーザーを使い分けることでセキュリティを担保しています。

![[Pasted image 20250831145751.png]]

---
##### 一般ユーザーの作成

###### adduserコマンド

一般ユーザーを作成する場合は、adduserコマンドを使用します。

```bash
adduser [ユーザー名]
```

例えば、**testuserを作成する場合は、以下のように実行します。**

```bash
adduser testuser
```

コマンドを実行すると、testuserのパスワードの入力が求められます。  
![[Pasted image 20250831145937.png]]
パスワードの入力が完了すると、ユーザーの作成が完了です。

ユーザーでログインする場合は、loginコマンドを実行します。

```bash
login testuser
```

コマンドを実行すると、testuserのパスワードが聞かれるので入力します。

パスワードの入力が完了すると、testuserでログインできます。  
![[Pasted image 20250831150014.png]]

現在のログインしているユーザーを確認する場合は、whoamiコマンドを実行します。

```bash
whoami
```

![[Pasted image 20250831150116.png]]

testuserからログアウトする場合は、logoutもしくは、exitを入力しましょう。

```bash
logout
#もしくは
exit
```

もう一度whoamiコマンドで確認すると、rootユーザーに戻っていることがわかります。
![[Pasted image 20250831150327.png]]

---
##### ユーザー情報は/etc/passwdファイルに

今回作成したtestuserのユーザー情報は、**/etc/passwdファイルに格納されています。**

ファイルの中身を確認する場合は、catコマンドを使用します。以下のように実行してみましょう。

```bash
cat /etc/passwd
```

コマンドを実行すると、以下のように表示されます。

![[Pasted image 20250831150931.png]]

先ほど作成した、testuserがあることが分かります。

ちなみに、/etc/passwdの1行目にrootユーザー(管理者ユーザー）があります。

---
##### /etc/passwdファイルの見方

**/etc/passwdファイルはユーザーの情報が格納されています。**

**では、ファイルの中身はどのような情報が格納されているのでしょうか？詳しく解説します。**

/etc/passwdファイルは、ユーザーの情報が一行ずつ格納されています。一行目は、以下のようになっています。

```
root:x:0:0:root:/root:/bin/bash
```

それぞれの値は、以下のような意味をもっています。

```
[ユーザー名]:[パスワード]:[ユーザーID]:[グループID]:[本名]:[ホームディレクトリ]:[ログインシェル]
```

今回のrootユーザーに当てはめてみると、

|           |            |
| --------- | ---------- |
| ユーザー名     | root       |
| パスワード     | x(暗号化されてx) |
| ユーザーID    | 0          |
| グループID    | 0          |
| 本名        | root       |
| ホームディレクトリ | /root      |
| ログインシェル   | /bin/bash  |

このような各ユーザーの情報が/etc/passwdファイルに格納されています。

---
##### ユーザーのID (UID)

**Linuxのユーザーには、idが割り振られています。**
これを**UID**と言います。

###### UIDの確認方法

IDは、idコマンドを使用することで確認することができます。

```bash
id [ユーザー名]
```

例えば、**rootユーザーのUIDを確認する場合は、以下のように実行します。**

```bash
id root
```

コマンドを実行すると、以下のように表示されます。

![[Pasted image 20250831151341.png]]

**rootユーザーのuidは0であることがわかります。**

また、前回紹介した/etc/passwdにもuidは記載されています。
以下の赤枠の部分がuidです。

![[Pasted image 20250831151356.png]]

ちなみに、uidを指定してユーザーを作成する場合は、adduserコマンドの”–uid”オプションを使用します。
![[Pasted image 20250831151446.png]]

idコマンドでtestuser2のuidを調べると、指定した1012番が設定されます。
![[Pasted image 20250831151458.png]]

**UIDの0から99までは、システム用のユーザーアカウントで予約されているため、それ以外の数字でUIDを指定しましょう。**

---
##### ユーザーのパスワードを設定・変更する方法

###### passwdコマンド

passwdコマンドは以下のように使用します。

```bash
passwd [ユーザー名]
```

例えば、testuserのパスワードを設定・変更したい場合は、以下のように実行します。

```bash
passwd testuser
```

新しいパスワードの入力が2回求められるので、入力したら完了です。

パスワードを忘れた際や、useraddコマンドでユーザーを作成した後などに使用しましょう。

![[Pasted image 20250831151614.png]]

---
##### Linuxのグループ

###### そもそもグループって何？

そもそもグループとは何なのでしょうか？

グループとは、**複数のユーザーの集合した単位のことです。**
![[Pasted image 20250831151818.png]]

---
##### グループの分け方

Linuxでグループを作る場合、どのようにユーザーを分ければ良いのでしょうか？

Linuxでは、**同じ権限を持つもの同士をグループ**にまとめます。

例えば、**Linuxでサーバーを構築するグループ**、**サーバーを運用するグループ**などです。

Linuxでサーバーを構築する場合、さまざまな設定ファイルを編集する必要があるため、多くの書き込み権限が必要です。

サーバーを運用する場合は、エラーが出ていないか、ログを確認する必要があるため、読み込み権限が必要です。

両者では、必要な権限がバラバラです。

各ユーザーに権限を割り当てると、非常に面倒になるので、**グループ単位で権限を割り当てます。**

![[Pasted image 20250831151912.png]]

このように、**必要な権限によってグループを分けます。**

---
##### プライマリグループとサブグループ

ユーザーは、**複数のグループに所属することができます。**

ユーザーは必ず１つのグループに所属します。**その基本的なグループをプライマリグループと言います。**
**プライマリグループ以外に所属しているグループをサブグループと言います。**

![[Pasted image 20250831152153.png]]

---
##### 所属グループの確認方法

ここからは、所属しているグループの確認方法について解説します。

グループを確認する方法は２つあります。

- /etc/passwdファイルの閲覧
- idコマンド

それぞれ解説します。

###### /etc/passwdファイルの閲覧

１つ目のグループの確認方法は、/etc/passwdファイルを確認します。

/etc/passwdファイルは以前も解説した通り、ユーザー情報が格納されています。

つまり、**/etc/passwdを見ることで、ユーザーがどのグループに所属しているのかも分かります。**

以下のコマンドを実行して、/etc/passwdファイルの中身を見てみましょう。

```bash
cat /etc/passwd
```

/etc/passwdの中身の**4番目の数字が所属しているグループ**です。

![[Pasted image 20250831152249.png]]

**この数字は、グループのIDを表しており、GIDと言います。**

今回の場合、userはグループID 1000のグループに所属していることになります。

GIDとグループ名は/etc/groupファイルに定義されています。

###### GIDとグループ名

GIDとグループ名は/etc/groupファイルを見ることで確認できます。

```bash
cat /etc/group
```

コマンドを実行すると、以下のように表示されます。

![[Pasted image 20250831152349.png]]

各情報の見方はこちらです。

```
[グループ名]:[グループパスワード]:[GID]:[所属しているユーザー]
```

testuserを例にすると、グループ名はtestuserで、GIDは1000ということがわかります。

※adduserコマンドでユーザーを作成すると、ユーザー名と同じグループ名が作成されます。

所属グループを調べるのに、/etc/passwdファイルと/etc/groupファイルの両方を見るのは面倒です。調査だけならidコマンドを使用しましょう。

###### idコマンド

idコマンドでは、所属しているユーザーのGIDやグループ名を表示してくれます。

```bash
id [ユーザー名]
```

例えば、testuserで実行してみましょう。

```bash
id testuser
```

コマンドを実行すると、以下のように表示されます。

![[Pasted image 20250831152538.png]]

このようにtestuserが所属しているグループとGIDが表示されます。

---
##### グループの作成方法

###### addgroupコマンド

addgroupコマンドは、以下のように使用します。

```bash
addgroup [グループ名]
```

例えば、testgroupという名前のグループを作成したい場合は、以下のように実行します。

```bash
addgroup testgroup
```

コマンドを入力したら、グループが作成されているか確認しましょう。

```bash
cat /etc/group
```

以下のように、testgroupが表示されたら成功です。

![[Pasted image 20250831152652.png]]

group1がGID 1001で作成されています。

グループはGIDが1000から順に作成されます。

前回testuserを作成した際に、testuserグループ(GID1000)が作成されたので、その次に作成したtestgroupはGID1001になります。

###### addgroupコマンドのオプション

addgroupコマンドには、以下のオプションがあります。

|        |          |
| ------ | -------- |
| オプション  | 説明       |
| -g GID | GIDを指定する |

GIDを指定したい場合は、次のように実行します。testgroup2という名前のグループをGIDを1010で作成します。

```bash
addgroup -g 1010 testgroup2
```

オプションを使わなくても、グループの作成はできるので参考程度に覚えておきましょう。

---
##### ユーザー情報を変更するusermodコマンド

###### usermodコマンドの使い方

**usermodコマンドは、ユーザー情報を変更するためのコマンドです。**

例えば、ユーザーの所属グループを変更したりuidを変更したりできます。

使い方は以下の通りです。

```bash
usermod [オプション] [ユーザー名]
```

さらに具体的な使い方を解説します。

###### シミュレーターでの準備

usermodコマンドはシミュレーターではデフォルトで使えないのでインストールします。

```bash
apk update
apk add shadow
```

![[Pasted image 20250831153103.png]]

コマンドを実行すると、usermodコマンドが使えるようになります。

apkコマンドについては、中級講座2パッケージ管理で詳しく解説します。

###### グループを変更する

**グループを変更する場合について解説します。**

グループを変更すると一言に行っても、プライマリグループを変更するのか、サブグループを変更するのかの2パターンあります。

プ**ライマリグループを変更する場合は、”-g”オプションを使用します。**

```bash
usermod -g [グループ名 or gid] [ユーザー名]
```

例えば、testuserのグループをtestgroup2に変更したい場合は、以下のように実行します。

```bash
usermod -g testgroup2 testuser
```

idコマンドで、testuserを確認すると、グループが変更されているのがわかります。
![[Pasted image 20250831153205.png]]

サブグループは複数に所属しても大丈夫です。複数のサブグループに所属させる場合は、”,”カンマでグループ名を区切って指定します。

例えば、**testuserのサブグループをgroup2とgroup3にしたい場合**は、以下のように実行します。

```bash
addgroup group2
addgroup group3
usermod -G group2,group3 testuser
```

![[Pasted image 20250831153934.png]]

idコマンドを使って、もう一度testuserを確認してみましょう。

![[Pasted image 20250831153949.png]]

サブグループとして、group2とgroup3が追加されています。

###### uidを変更する

uidを変更する場合は、”-u”オプションを指定します。

```bash
usermod -u [uid] [ユーザー名]
```

例えば、user1のuidを1011に変更したい場合は以下のように実行します。

```bash
usermod -u 1011 testuser
```

すでに他のユーザーが同じuidを使用している場合は、”-o”オプションをつけると、他のユーザー同じuidでも設定できます。

```bash
usermod -u 1012 -o testuser
```

![[Pasted image 20250831154030.png]]