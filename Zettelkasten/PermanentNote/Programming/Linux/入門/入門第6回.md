---
title: Linux講座第7回
AI:
published: 2025-08-31
description:
tags:
  - permanent-note
---
**Linux講座**
- https://engineer-ninaritai.com/infraacademy/course-category/linux/?loop_content_only=false&column_per_row=3&course_per_page=12&show_pagination=false&keyword=Linux%E5%85%A5%E9%96%80&tutor-course-filter-category=57&course_order=oldest_first&course_filter=true&loop_content_only=false&column_per_row=3&course_per_page=12&show_pagination=false&current_page=1&action=tutor_course_filter_ajax

---
##### ネットワークとは
**ネットワークとは、複数のPCが接続された状態のことを差します。**

つまり、2台のPCをケーブルで接続したものや、Wifiなどを使用して複数のPCを接続したものがネットワークになります。

こちらがイメージ図です。
![[Pasted image 20250831211504.png]]

こちらは、PCが2台だけ接続された最小のネットワークです。
普通のネットワークは、さらにPCやスマホなど、さまざまな機器が接続されて、お互いに通信をします。

---
##### ネットワークの種類

ネットワークには、**LAN(ラン)とWAN(ワン)の2種類があります。**

###### LANとは？

**LANはローカルエリアネットワークの略で、限られた範囲内で構築されたネットワークのことを言います。**

限られた範囲内とは、建物やフロアのことです。例えば、家のネットワークや会社のネットワークはLANといえます。
![[Pasted image 20250831211600.png]]

無線LANやスイッチ、ルーターなどのネットワーク機器でLANを構築します。

###### WANとは？

WAN(ワン)とは、wide area networkの略で広い範囲のネットワークでだれでもアクセス可能なネットワークです。

**つまり、インターネットです。**

**WANは通信事業者(プロバイダー)が構築を行います**。

携帯やPCを買うときに一緒にプロバイダー契約をしたと思います。プロバイダーと契約することでWANへのアクセスが可能になります。

また、WANは複数のLANの集合体でもあります。

WANをイメージすると、以下のような図になります。

![[Pasted image 20250831211648.png]]

---
##### 通信の基礎IPアドレス

ネットワークは、ケーブルなどでPCを複数台つなぐことで構築できます。そもそも、ネットワークはPC同士で通信をするために構築するものです。通信を行なって、データのやり取りを行います。

データをやり取りを行う場合には、データの送り先を指定してあげる必要があります。

データを送る先を指定するために、**IPアドレス**を指定します。

今回は、IPアドレスについて解説します。

###### IPアドレスとは？

Pアドレスは**通信を行うために必要な情報**です。

データをどのPCに送るのか、IPアドレスで判断しています。

PC同士の通信のやり取りを手紙のやり取りとイメージすると分かりやすいと思います。

手紙を送るときは、あて先の住所を記入します。

**PCのやり取りも同じで、送信先のPCのIPアドレスをデータに付けて送信します。**
![[Pasted image 20250831213104.png]]

**IPアドレスは、192.168.1.1や172.153.233.21のように、0~255の数字を、.(ドット)で４つに区切って表します。**

次に自分のPCがどのようなIPアドレスが指定されているのかを確認してみましょう。

---
##### 自分のPCのIPアドレスを確認してみる

IPアドレスは、”192.168.0.1″のように4つの区切りの数字で表します。ネットワークに接続されている場合は、IPアドレスが設定されています。

自分のPCにどのようなIPアドレスが割り当てられているのか、確認してみましょう。WindowsとMacで方法が若干違うので、それぞれ解説します。

###### LinuxでIPアドレスを確認する

シミュレーターで以下のコマンドを入力します。

```bash
ifconfig
```

実行結果は以下の通りです。
![[Pasted image 20250831213306.png]]

**eth0の10.0.31.5の部分がIPアドレスです。**

###### Windowsで自分のIPアドレスを確認する

**ご自身のOSがWindowsの方のみお試しください。**
まず、**コマンドプロンプト**を立ち上げます。
起動の方法は 「Windowsボタン」→「**cmd**」と検索し、クリックします。

コマンドプロンプトを起動するとこのような黒い画面が表示されます。
![[Pasted image 20250831213402.png]]

コマンドプロンプトにIPアドレスを確認するコマンド「**ipconfig**」というコマンドを入力します。

```bash
ipconfig
```

「ipconfig」の読み方は”アイピーコンフィグ”です。「ipconfig」コマンドはよく使うので覚えておきましょう。

「ipconfig」コマンドを入力してenterを押すと”**IPv4アドレス　・・・**“というところに自分のPCのIPアドレスが表示されます。
![[Pasted image 20250831213419.png]]

↑の画面の”**192.168.100.107**“というのが自身のIPアドレスになります。


###### Macの場合

**ご自身のOSがMacの方のみお試しください。**

まず、キーボードの”F4″の虫眼鏡マークをクリックします。

その後、「terminal」と検索して、”ターミナル”をクリックしましょう。
![[Pasted image 20250831213527.png]]

ターミナルを開いたら、”ifconfig”とコマンドを入力します。

```bash
ifconfig
```

![[Pasted image 20250831213537.png]]

コマンドを入力すると、文字列がずらっと出ます。その中の”inet ~”の部分がIPアドレスになります。
![[Pasted image 20250831213557.png]]

---
##### eth0とは？

###### ネットワークインタフェースとは？

前回、ifconfigコマンドを実行した際、eth0やeth1、docker0など左側に出力されました。
![[Pasted image 20250831213638.png]]

これらは、**ネットワークインターフェースを識別するためのラベル**です。

**ネットワークインターフェースは、コンピュータや他のデバイスがネットワークに接続され、データの送受信を行うためのものです。**

![[Pasted image 20250831213654.png]]

例えば、LANケーブルを差し込む部分やWifiなどがネットワークインターフェースに該当します。

上記の画像のような、LANケーブルを差し込む機器のことをNIC(ニック)と呼びます。NICはネットワークインターフェースカードの略です。

今回のシミュレーターの場合は、ネットワークインターフェースを仮想的に作成して、通信を行なっています。

###### eth0とは？

“eth” は Ethernet の略です。

Ethernet(イーサネット）は、有線ネットワーク技術の一つで、コンピュータやネットワークデバイスが有線ケーブルを使用してデータ通信を行うための標準プロトコルです。

ネットワークインターフェースを表す際には、Ethernetの略のethを使い、１番目のネットワークインターフェースをeth0、2番目のネットワークインターフェースをeth1としています。

ネットワークインターフェースはeth以外にも、wifiの場合は”wlan0″、localhost(自分自身への通信)は”lo”など様々な表記があります。

---
##### IPアドレスを使って通信してみよう

###### pingコマンドの使い方

**通信確認するときは、ping(ピング)コマンドを使用します。**

```bash
ping [通信したいIPアドレス]
```

シミュレーターでインスタンスを2つ作成します。メニューより、[ +インスタンスを作成 ]をクリックします。
![[Pasted image 20250831230341.png]]

node1とnode2が作成できればOKです。

それぞれのインスタンスのIPアドレスは、メニューに書かれている通り、

node1は10.0.31.5、node2は10.0.31.6になります。

**node1から以下のコマンドを入力しましょう。**IPアドレスはnode2を指定します。

```bash
ping 10.0.31.6
```

node2のIPアドレスはシミュレーターによって変わるので、ご自身の環境に合わせて入力してください。

コマンドを入力すると以下のように表示されます。
![[Pasted image 20250831230844.png]]

**「64 byte from 10.0.31.6 ~」と表示していると通信できています。**

何も表示されない場合は、通信が失敗している可能性があります。node2のIPアドレスが正しく入力されているか確認しましょう。

**pingコマンドは[ctrl] + cキーを押すと終了します。**

###### pingコマンドの仕組み

**pingコマンドとは、ICMP（Internet Control Message Protocol）を使って、ネットワーク接続確認をするためのコマンドです。**

pingコマンドを実行すると、PCは指定した宛先のに向けてICMP Echo Requestメッセージを送信します。

これは、「送ったデータをそのまま返して」という内容のメッセージです。

![[Pasted image 20250831230923.png]]

対象のホストがICMP Echo Requestメッセージを受信すると、対象ホストはICMP Echo Replyメッセージを作成して送信元に返信します。

ICMP Echo Replyメッセージが正常に返ってくれば、正常に通信できることが確認できます。
![[Pasted image 20250831230946.png]]

このような仕組みを使って通信確認が行えます。

---
##### IPアドレスの構造

Pアドレスは**ネットワーク部**と**ホスト部**という２種類で構成されています。

- ネットワーク部→**どこのネットワークに所属しているのかを識別**
- ホスト部→**ネットワーク内のPCを識別**

###### ネットワーク部、ホスト部とは？

IPアドレスの**ネットワーク部はPCがどこのネットワークに所属しているのか**を表し、**ホスト部はそのネットワーク内で割り当てられた番号**のことです。
![[Pasted image 20250831231322.png]]
![[Pasted image 20250831231326.png]]

住所で分かりやすく例えると、

ネットワーク部→都道府県市町村
ホスト部→番地

ということです！

![[Pasted image 20250831231433.png]]

突然ですが、ここで問題です。

**IPアドレスが”192.168.1.2″の場合、どこがネットワーク部で、どこがホスト部でしょうか？**

IPアドレスは “.”で数字が区切られていますがどこからネットワーク部で、どこからホスト部なのかというのは、**クラス**や****CIDR****、**サブネットマスク**の知識があれば分かります。

次にサブネットマスクについて解説します。

---
##### サブネットマスク

###### サブネットマスクとは？

サブネットマスクは、この**“ネットワーク部”と”ホスト部”**をIPアドレスで識別するための数字です。
![[Pasted image 20250831234347.png]]

サブネットマスクは255.255.255.0のようにIPアドレス同様、”.”で４つに区切られた形をしています。

では、具体的にどのようにネットワーク部とホスト部を区別しているのでしょうか？

ここからは、**サブネットマスクの仕組み**について解説していきます！

###### サブネットマスクの見方

**ネットワーク部とホスト部を区切るためには、サブネットマスクが必要です**。サブネットマスクとはネットワークの大きさを表すものです。

今回は「255.255.255.0」をサブネットマスクとします。

**サブネットマスクを2進数に変換し、１の部分がネットワーク部、0の部分がホスト部です。以下の図をご覧ください。**
![[Pasted image 20250831234441.png]]

「255.255.255.0」を2進数に変換すると、「11111111.11111111.11111111.00000000」となります。

“1”の部分がネットワーク部なので、第１~第３オクテッド(左側3つの区画)までがネットワーク部になり、右側の第４オクテッドがホスト部となります。

先ほどの192.168.1.2に照らし合わせてみると以下のようになります。
![[Pasted image 20250831234537.png]]

###### CIDR表記

**サブネットマスクにはCIDR表記という表現方法があります。**/24や/16といった表現の方法です。

サブネットマスクを255.255.255.0と書くのは面倒です。

IPアドレスと合わせて書くと、”192.168.1.2/255.255.255.0″と書くのは長すぎます。

そこで、**サブネットマスクを2進数にした場合の”1″の個数を数えて、/24個と表現します。**

255.255.255.0を2進数にすると、「11111111.11111111.11111111.00000000」となり、1が24個並びます。

そのため、CIDR表記にすると/24になります。
![[Pasted image 20250831234631.png]]

###### 覚えておくべきCIDRとサブネットマスク

サブネットマスクとCIDRをいちいち計算して求めるのは面倒です。

そこで、よく使われるCIDR、サブネットマスクは覚えておきましょう。

よく使われるのは、以下の3つです。

- /24 (255.255.255.0)
- /16 (255.255.0.0)
- /8 (255.0.0.0)

それぞれ、”.”の位置でネットワーク部とホスト部の境目が変わります。

以下の図をご覧ください。
![[Pasted image 20250831234710.png]]

このように、/24 /16 /8はそれぞれ、.(ドット)の位置がネットワーク部とホスト部の境目になります。

これを覚えておけば、

- 192.168.1.1/24の場合、ネットワーク部が192.168.1、ホスト部が1
- 172.16.10.100/16の場合、ネットワーク部が172.16、ホスト部が10.100
- 10.0.0.1/8の場合、ネットワーク部が10、ホスト部が0.0.1

このような内容が瞬時に理解できます！

---
##### ipコマンドの使い方

###### ipコマンドの書式

ipコマンドは以下のように使います。

```bash
ip [オプションやサブコマンドなど]
```

ipコマンドの使い方をさらに詳しく解説します。

###### ipアドレスの確認方法

まず、**IPアドレスの確認方法**です。

IPアドレスの確認は以下のコマンドを実行します。

```bash
ip address
```

コマンドを実行すると、以下のように表示されます。
![[Pasted image 20250831235507.png]]

ifconfigコマンド同様、eth0のIPアドレス10.0.31.5が表示されました。

###### IPアドレスの追加方法

続いて、IPアドレスの追加方法です。

```bash
ip address add [IPアドレス/サブネットマスク] dev [ネットワークデバイス]
```

**例えば、”eth0″に10.0.31.100※のIPアドレスを設定する場合は、以下のコマンドを実行します。**

```bash
ip address add 10.0.31.100 dev eth0
```

(※node1のIPアドレスの第４オクテッドを100にしたIPアドレスを設定してみましょう。

例えば、node1のIPアドレスが10.0.112.5であれば、10.0.112.100と設定しましょう。)

コマンドを実行すると、eth0にIPアドレスを追加します。

コマンドを実行したら、ip addressコマンドを使って、IPアドレスが設定されているか確認してみましょう。
![[Pasted image 20250901000652.png]]

シミュレーターのnode2から10.0.31.100へ通信ができるのかも確認してみましょう。

```bash
ping 10.0.31.100
```

コマンドを実行すると、pingで通信ができます。

![[Pasted image 20250901000710.png]]

###### IPアドレスの削除

IPアドレスの削除を実施する場合は、以下のように実行します。

```bash
ip address del [IPアドレス/サブネットマスク] dev [ネットワークデバイス]
```

先ほどのシミュレータで設定した”eth0″のIPアドレスを削除する場合は、以下のコマンドを実行します。

```bash
ip address del 10.0.31.100 dev eth0
```

コマンドを実行後ip addressコマンドで確認すると、以下のようにIPアドレスが消えていることがわかります。

---
##### ip routeコマンドの使い方

ここからは、ip routeコマンドの使い方について解説します。

ip routeコマンドの前にネットワークの用語を2つ解説します。

**ルーティング**と**デフォルトゲートウェイ**です。

###### ルーティングとゲートウェイ

**ルーティング**とは、データを目的地まで適切に届ける制御のことです。

例えば、Webサイトを閲覧する際、Webサイトがあるサーバーまで通信する必要があります。

そのサーバーまで、適切にデータを届ける制御がルーティングです。ルーティングは、ルーターなどのネットワーク機器で実施されます。

また、インターネット上のサーバーなど、どこにあるか分からない場所へ通信をする際、一番最初に送る先が**デフォルトゲートウェイ**です。

異なるネットワーク間同士の通信を行う際は、デフォルトゲートウェイの設定が必要になります。

![[Pasted image 20250901001022.png]]

ルーティングとデフォルトゲートウェイをもっと詳しく理解したい方は、ネットワーク講座を受講しましょう。

- [【ネットワーク講座2】ルーターを使った通信](https://engineer-ninaritai.com/infraacademy/courses/network-2/)
- [【ネットワーク講座3】ルーティング](https://engineer-ninaritai.com/infraacademy/courses/network-3/)

###### ip routeコマンドでデフォルトゲートウェイの設定

ip routeコマンドでデフォルトゲートウェイを設定する方法は以下の通りです。

```bash
ip route add default via [IPアドレス]
```

例えば、デフォルトゲートウェイを192.168.1.254に設定したい場合は、以下のように実行します。

[シミュレーターを起動](https://terminal.engineer-ninaritai.com/)して試してみましょう。

```bash
ip route add default via 192.168.1.254
```

※シミュレーターでは、すでにデフォルトゲートウェイが設定されているので、エラーが出ると思います。

デフォルトルートなどルーティング情報の確認は、以下のコマンドを実行します。

```bash
ip route
```

コマンドを実行すると、以下のように表示されます。
![[Pasted image 20250901001149.png]]

シミュレーターでは、172.18.0.1がデフォルトルートになっています。
eth0ではnode間の通信、eth1側で外部ネットワークの通信ができるようになっています。

###### ip routeコマンドでルーティングの設定

ip routeコマンドでルーティングの設定する方法は以下の通りです。

```bash
ip route add [宛先ネットワーク/サブネットマスク] via [経由先] dev [ネットワークデバイス]
```

例えば、172.16.0.0/16のネットワークをゲートウェイの172.18.0.1へ送りたい場合は、以下のように設定します。

```bash
ip route add 172.16.0.0/16 via 172.18.0.1 dev eth1
```

ip routeコマンドでルーティング情報を確認すると、追加した172.16.0.0/16のネットワークが追加されます。
![[Pasted image 20250901001255.png]]

このように手動で設定した経路を静的ルート(スタティックルートと言います。)

