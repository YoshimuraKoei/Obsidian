---
title: Linux講座中級第6回
AI:
published: 2025-09-09
description:
tags:
  - permanent-note
---
**Linux講座**
- https://engineer-ninaritai.com/infraacademy/course-category/linux/?loop_content_only=false&column_per_row=3&course_per_page=12&show_pagination=false&keyword=Linux%E4%B8%AD%E7%B4%9A&tutor-course-filter-category=57&course_order=oldest_first&course_filter=true&loop_content_only=false&column_per_row=3&course_per_page=12&show_pagination=false&current_page=1&action=tutor_course_filter_ajax

---
##### シェルスクリプトとは？

ここからは、シェルスクリプトの概要について解説します。

###### シェルスクリプトとは

シェルスクリプトとは、LinuxやUNIXシステムで使用されるスクリプト言語です。

**一連のコマンドを自動化し、複雑なタスクを簡単に実行するために使用されます。**

スクリプトには、手順や順序という意味があります。

例えば、**“ファイルを圧縮して、コピーする”といった複数のコマンドを1つのシェルスクリプトとして実行します。**

すると、複数のコマンドを入力する必要がなく、1つのシェルスクリプトの実行だけで済みます。

![[Pasted image 20250909134210.png]]

---
##### シェルスクリプトの活用場所

シェルスクリプトは、コマンドの自動化や複雑な処理を可能にします。

そのため、さまざまな場面で活用されます。

例えば、以下のような場面です。

- **バックアップなどのタスクの自動化**
- **繰り返し処理**
- **レポートの生成などの複雑な処理**
- ・・・etc

###### バックアップなどのタスクの自動化

シェルスクリプトの1つ目の活用場所は、**バックアップなどのタスクの自動化**です。

バックアップの操作は、ファイルを圧縮し、特定の場所に保存するといった処理があります。

このような複数の処理をシェルスクリプトとしてまとめます。

その他の処理としては、**ユーザー管理**や、**ネットワーク設定**など、日頃の業務で毎回行う操作をシェルスクリプトとして自動化します。

###### 繰り返し処理

シェルスクリプトの2つ目の活用場所は、**繰り返し処理**です。

例えば、1000枚の画像を圧縮したいとします。

この時、1000回コマンドを実行するのは、大変手間です。

そこでシェルスクリプトに、1000枚の画像を圧縮する操作を記述します。

このように、何回も繰り返す処理をシェルスクリプトを使って、簡単に実行します。

そのほか、ユーザー作成やファイル作成などにも繰り返し処理は活用できます。

###### **レポートの生成などの複雑な処理**

シェルスクリプトの3つ目の活用場所は、**レポート生成などの複雑な処理**です。

例えば、ログデータを読み込んでレポートを生成したい場合、

1.ログデータを読み込む

2.複数のログデータを処理できるように整形

3.ログデータを計算

4.レポートに出力

といった処理が走ります。

レポートの内容を複雑にすると、さらに処理が増えます。

このような処理をシェルスクリプトとしてまとめて実行します。

シェルスクリプトを活用することで、複雑な処理もできるようになります。

---
##### Hello Worldと表示するシェルスクリプトの作成

ここからは、**簡単なシェルスクリプトを作成してみましょう。**

まずは、Hello Worldと表示する簡単なスクリプトです。

###### シェルスクリプトの作成

シェルスクリプトとは、プログラムやコマンドを記述したファイルのことです。

テキストファイルを編集してシェルスクリプトの作成を行います。

[シミュレーター](https://terminal.engineer-ninaritai.com/)を起動して、以下のコマンドを実行しましょう。

```bash
vi script.sh
```

シェルスクリプトは.shの拡張子を持ちます。

**script.shファイルの中身に以下のように記述します。**

```bash
#!/bin/bash
echo "Hello World"
```

上記の内容が記述できたら、**ファイルを保存して閉じます。**

1行目の**#!/bin/bash**は「シバン（shebang）」と呼ばれ、スクリプトを実行する際にどのシェルを使用するかをシステムに伝えます。

2行目のechoコマンドは、今回実施したい”Hello World”の文字を出力する処理です。

### ファイルに実行権限を付ける

シェルスクリプトを実行するためには、script.shファイルに実行権限をつけます。

以下のコマンドを実行します。

```bash
chmod +x script.sh
```

### シェルスクリプトの実行

続いて、シェルスクリプトを実行してみましょう。以下のように実行します。

```bash
./script.sh
```

**スクリプトを実行すると、Hello Worldと出力されました。**
![[Pasted image 20250909134613.png]]

**スクリプトを実行する際は、絶対パスで指定するか、相対パスで指定する場合は、./[ファイル名]と指定しましょう。**

ファイル名だけ指定すると、コマンドと認識されてエラーが発生します。ファイル名だけ指定して実行するには、パスを通す必要があります。(後ほど解説します。)
![[Pasted image 20250909134632.png]]

###### (参考)スクリプトの実行方法

sourceコマンドもしくはbashコマンドを使ってもスクリプトを実行することが可能です。

```bash
source script.sh
```

bashコマンドを使う場合は、以下のように実行します。

```bash
bash script.sh
```

また、**sourceは.(ドット)と省略して実行することも可能**です。

```bash
. script.sh
```

上記のコマンドを実行すると、script.shのスクリプトが実行されます。

sourceコマンドを使う場合は、script.shに実行権限を付けなくてもスクリプトを実行できます。
![[Pasted image 20250909134701.png]]

---
##### 変数の使い方

前回は、簡単なシェルスクリプトを作ってみました。

ここからは、シェルスクリプトのさまざまな使い方について解説します。

まずは、変数について解説します。

###### 変数とは？

**変数とは、値を入れておく箱のことです。変数という箱の中に値が入っています。**

変数は文字通り、変わる数です。

つまり、値は一定ではなく、変えることが可能です。
![[Pasted image 20250909134749.png]]

###### 変数の使い方

ここからは、変数の使い方について解説します。

まず、シェルスクリプトを記述するファイルを開きます。

[シミュレーター](https://terminal.engineer-ninaritai.com/)を開いて以下のコマンドを実行しましょう。

```bash
vi script2.sh
```

ファイルの中身に以下の内容を記述します。

```bash
#!/bin/bash

MY_VAR="Hello World!"
echo $MY_VAR
```

**MY_VARが変数**となります。  
MY_VARに”Hello World”という値を代入しています。  
echoコマンドを使って、変数の中身を出力します。  
変数には、$を先頭につけてアクセスします。$[変数名]

**ファイルを保存して、シェルスクリプトを実行してみましょう。**

```bash
chmod +x script2.sh
./script2.sh
```

**スクリプトを実行すると、Hello World!と出力されました。**
![[Pasted image 20250909134815.png]]

###### コマンドの実行結果を変数に保存

続いて、**コマンドの実行結果を変数に保存する方法**です。

コマンドの実行結果を変数に保存する場合は、以下のように指定します。

```bash
[変数名] = $(コマンド)
```

例えば、日付(dateコマンドの実行結果)を変数に代入して出力してみましょう。  
先ほど編集したスクリプトファイルを開きます。

```bash
vi script2.sh
```

**以下のようにscript2.shファイルを編集しましょう。**

```bash
#!/bin/bash

MY_VAR=$(date)
echo $MY_VAR
```

**スクリプトを実行してみましょう。**

```bash
./script2.sh
```

実行すると、以下のようにdateコマンドの結果が表示されました。
![[Pasted image 20250909134932.png]]

---
##### 引数の使い方

続いて引数の使い方について解説します。

### 引数とは？

引数とは、**スクリプトに渡される外部からの値や情報です。**

これらの引数は、スクリプト内で処理や操作に使用することができます。

例えば、コマンドのオプションやファイル名の指定などが引数に当たります。

echo file.txtのfile.txtの部分が引数に当たります。

```bash
コマンド 引数1 引数2
```

引数はパラメーターと呼ばれることもあります。

### 引数の使い方

続いて引数の使い方を解説します。

以下のコマンドを実行して、スクリプトファイルを開きます。

```bash
vi script3.sh
```

ファイルの中に以下のように記述しましょう。

```bash
#!/bin/bash

echo "arg1: $1"
echo "arg2: $2"
```

編集が完了したら、保存して閉じます。

スクリプトに引数を指定して、実行させます。

**今回は引数にtest1とtest2を指定します。**

```bash
chmod +x script3.sh
./script3.sh test1 test2
```

コマンドを実行すると、以下のように表示されました。
![[Pasted image 20250909140057.png]]

**スクリプトの2行目の$1の部分に1つ目の引数”test1″が代入されています。**

**スクリプトの3行目の$2の部分に2つ目の引数”test2″が代入されています。**
![[Pasted image 20250909140113.png]]

###### 引数の記号一覧

引数は、$1、$2のような記号を使ってアクセスすることができます。

そのほかには、以下のようなものがあります。

|特殊記号|説明|
|---|---|
|`$0`|スクリプト自体の名前を示します。|
|`$1`, `$2`, `$3`, …|スクリプトに渡された位置引数を示します。`$1` は最初の引数、`$2` は2番目の引数、といった具体的な値を持ちます。|
|`$#`|引数の総数を示します。|
|`$*`|すべての引数を一つの文字列として示します。|
|`$@`|引数を個別の引用符で区切って示します。|
|`$?`|直前に実行されたコマンドの終了ステータスを示します。通常、0は成功を示し、非ゼロはエラーを示します。|
|`$$`|スクリプト自体のプロセスID（PID）を示します。|

**script3.shを編集して試してみましょう。**

```bash
vi script3.sh
```

以下のように内容を編集します。

```bash
#!/bin/bash

echo "script name: $0"
echo "num args: $#"
echo "all args: $*"
echo "arg: $1, $2, $3"
```

コマンドを実行すると以下のように表示されます。
![[Pasted image 20250909140223.png]]

---
##### readによる入力受け付け

前回は引数を使って、スクリプトの外からデータを取得しました。

次は、**readコマンドを使って、ユーザーにデータの入力をさせます。**

###### readの使い方

**readコマンドは、ユーザーにデータを入力させるために使用します。**

まず、スクリプトファイルを開きましょう。

```bash
vi script4.sh
```

**スクリプトファイルに以下の内容を記述します。**

```bash
#!/bin/bash

echo "Enter your name:"
read name
echo "Hello! $name"
```

**スクリプトに実行権限を付けて実行してみましょう。**

```bash
chmod +x script4.sh
./script4.sh
```

コマンドを実行すると、**“Enter your name:”と名前の入力が求められます。**
![[Pasted image 20250909140343.png]]

適当にtanakaと入力してEnterを押します。

すると、”Hello! tanaka”と表示されました。
![[Pasted image 20250909140353.png]]

###### readコマンドの書式

readコマンドの書式は以下の通りです。

```bash
read [変数名]
```

今回の場合は、変数名をnameとして、

4行目のecho “Hello $name”の部分でユーザーから入力された値を表示しています

---
##### if文

if文は条件分岐を行います。

**if文は、指定した条件が真または偽である場合に異なる処理を行います。**

###### if文の書式

if文は以下のような書式です。

```bash
if [ 条件 ]; then
 #条件が真の場合に実行する処理
else
 #条件が偽の場合に実行する処理
fi
```

ここで、条件は評価する条件式で、条件が真の場合に then ブロック内の処理が実行され、条件が偽の場合に else ブロック内の処理が実行されます。  
また、fi は if 文の終了を示します。

###### if文の使い方

**続いてif文を使って、スクリプトを記述します。**

今回作成するスクリプトは、年齢を入力して、成人の場合はTrue、成人ではない場合はFalseを返します。

まず、スクリプトファイルを開きましょう。

```bash
vi script5.sh
```

スクリプト内には以下のように記述します。

```bash
#!/bin/bash

echo "How old are you?:"
read age

if [ $age -ge 18 ]; then
 echo True
else
 echo False
fi
```

ファイルが保存できたら、スクリプトを実行してみましょう

```bash
chmod +x script5.sh
./script5.sh
```

スクリプトを実行すると、前回同様入力が求められます。そこで数字を入力してみましょう。

`$age` 変数の値が18以上の場合に成人とみなされTrueを返し、それ以外の場合は未成年とみなされFalseを返します。
![[Pasted image 20250909140606.png]]

###### 条件式を増やしたい場合

**条件式を増やしたい場合は、elifを使用します。**

```bash
if [ 条件1 ]; then
 #条件1が真の場合に実行する処理
elif [ 条件2 ]; then
 #条件2が真の場合に実行する処理
else
 #条件が偽の場合に実行する処理
fi
```

このようにif文を使用します。

---
##### case文

case文は条件分岐の制御を行います。

**case文は特定の値に対して複数の選択肢を持つ場合に使用されます。**

### case文の書式

case文は以下のように使用します。

```bash
case 値 in
"ケース1")
  #ケース1の条件 ;;
"ケース2")
  #ケース2の条件 ;;
"ケース3")
  #ケース3の条件 ;;
*)
  #ケースに当てはまらない場合の条件 ;;
esac
```

###### case文の使い方

続いて**case文の使い方を説明します。**

スクリプトファイルを開きましょう。

```bash
vi script6.sh
```

スクリプト内に以下の内容を記述します。

```bash
#!/bin/bash

fruit="apple"

case $fruit in
"apple")
echo "apple was chosen";;

"banana")
echo "banana was chosen";;

"cherry")
echo "cherry was chosen";;

*)
echo "nothing"
;;

esac
```

このスクリプトでは、`$fruit` の値が各パターンに一致するかどうかをチェックし、適切なメッセージを表示します。値がどのパターンにも一致しない場合、デフォルトのメッセージ”notiong”が表示されます。

続いて、**作成したスクリプトを実行してみましょう。**

```bash
chmod +x script6.sh
./script6.sh
```

**スクリプトを実行すると、”apple was chosen”と表示されました。**
![[Pasted image 20250909141611.png]]

---
##### for文

for文は繰り返し処理です。

**一連の値に対して繰り返し処理を行います。**

###### for文の書式

for文は以下のように使います。

```bash
for 変数 in アイテム1 アイテム2 ... アイテムN 
do 
　#繰り返しの処理
done
```

`変数`はループの各繰り返しで異なる値（アイテム1、アイテム2、…、アイテムN）を取ります。

アイテムがある限り、doとdoneの間の処理が繰り返し実行されます。

###### for文の使い方

では、実際にfor文を記述してみましょう。

スクリプトファイルを開きましょう。

```bash
vi script7.sh
```

続いて、ファイルの中に以下の内容を記述します。

```bash
#!/bin/bash
for i in 1 2 3 4 5 
do
 echo "Number $i"
done
```

このスクリプトは、アイテムである1~5の数字を順番に変数に入れ、それぞれ、echoコマンドを実行しています。

スクリプトを実行してみましょう。

```bash
chmod +x script7.sh
./script7.sh
```

コマンドを実行すると、Number 1からNumber 5まで出力されました。
![[Pasted image 20250912002946.png]]

###### for文で100回繰り返す

先ほどfor文でアイテムを指定する際、”1 2 3 4 5″と記述しました。

これは、アイテムが少数なら問題ありませんが、100回繰り返すとなると、100までの数字を記述するのは現実的ではありません。

そこで、展開を使うか、seqコマンドを使って、100までの繰り返しを実行することができます。

**展開を使う方法は以下のように、{1..100}と指定します**。

```bash
#!/bin/bash
for i in {1..100}
do
 echo "Number $i" 
done
```

**seqコマンドを使う場合は以下のように$(seq 1 100)と指定します。**

```bash
#!/bin/bash
for i in $(seq 1 100)
do
 echo "Number $i"
done
```

どちらのスクリプトを実行しても、Number 1 ~ Number 100と出力されます。

###### ファイルやディレクトリに対するループ

ファイルやディレクトリをアイテムに指定することも可能です。

準備のために、ディレクトリとファイルを作成しましょう。

```bash
mkdir /testdir
touch /testdir/file{1..5}
```

/testdirディレクトリ配下にfile1~file5が作成されました。

続いて、スクリプトの編集をします。

```bash
vi script7.sh
```

スクリプトの内容を以下に書き換えます。

```bash
#!/bin/bash

for file in /testdir/*
do
 echo "File: $file"
done
```

コマンドを実行すると、file1~file5までのパスが表示されました
![[Pasted image 20250912003041.png]]

---
##### while文

while文は、繰り返し処理です。

指定された条件が真(true)である間、繰り返しコマンドを実行します。

###### while文の書式

while文は以下のように使います。

```bash
while [ 条件 ]
do
 #繰り返し実行する処理
done
```

[条件]は繰り返し処理をする条件式です。

この条件が真(true)の間、doとdoneの間に記述されたコマンドが実行されます。

###### while文の使い方

では、実際にfor文を記述してみましょう。

スクリプトファイルを開きましょう。

```bash
vi script8.sh
```

続いて、ファイルの中に以下の内容を記述します。

```bash
#!/bin/bash

count=1
while [ $count -le 5 ]
do
 echo "Count: $count"
 count=$((count + 1))
done
```

このスクリプトは、countが1から始まり、5以下である間、countの値を出力し、その後countを1増やします。

countが5を超えるとループは終了します。

実際にスクリプトを実行してみましょう。

```bash
chmod +x script8.sh
./script8.sh
```

スクリプトを実行すると、Count: 1 ~ Count: 5と出力されました。
![[Pasted image 20250912003133.png]]

---
##### 条件式について

前回はwhile文について解説しました。

続いて、条件式についてさらに詳しく解説します。

###### 条件式の基本

while文は条件が真(true)の場合、繰り返し処理を実行します。

条件は、以下のように記述します。

```bash
while [ 条件 ]
```

**[ ] の中にさまざまな条件を記述することで、さまざまな処理を行うことができます。**

**if文も同様に [ 条件 ]と指定します。**

[ ]はtestコマンドと同じ書式で条件を記述することができます。

今回は条件式の指定方法を詳しく解説します。

###### 数値の比較

**数値の比較をする場合**は、以下の演算子が設定できます。

|演算子|意味|
|---|---|
|-eq|等しい（equal）|
|-ne|等しくない（not equal）|
|-lt|より小さい（less than）|
|-le|以下（less than or equal）|
|-gt|より大きい（greater than）|
|-ge|以上（greater than or equal）|

例えば、countが５以下である場合にループが続くようにするには、以下のように記述します。

```bash
#!/bin/bash

count=1

while [ $count -le 5 ]
do
 echo "Count: $count"
 count=$((count + 1))
done
```

[ $count -le 5]の部分が条件式です。

###### 文字列比較

**文字列を比較する場合**は、以下の演算子が利用できます。

|演算子|意味|
|---|---|
|=|等しい|
|!=|等しくない|
|-z|文字列が空（zero）|

例えば、$strが”Goodbye”ではない間、ループが続きます。

```bash
#!/bin/bash

str="Hello"

while [ "$str" != "Goodbye" ]
do
 echo "$str"
 str="Goodbye"
done
```

###### ファイルテスト演算子

**ファイルやディレクトリに関する条件もチェックすることができます。**

以下の演算子が利用できます。

|演算子|意味|
|---|---|
|-f|ファイルが存在し、通常のファイルである|
|-d|ディレクトリが存在する|
|-e|ファイル/ディレクトリが存在する|
|-s|ファイルが存在し、サイズが0より大きい|
|-r|ファイルが読み取り可能である|
|-w|ファイルが書き込み可能である|
|-x|ファイルが実行可能である|

以下の例では、/testdir/file.txtが存在するまでループが続きます。

```bash
#!/bin/bash

while [ ! -f "/testdir/file.txt" ]
do
 echo "Waiting for file.txt to be created"
 sleep 1
done
```

!マークは論理否定を意味します。条件の真偽を反転させます。

-fはファイルが存在するという条件で、真(true)になります。しかし**!マークをつけることで、ファイルが存在しない場合に真(true)になります。**

###### 条件の組み合わせ

複数の条件を組み合わせることもできます。

複数の条件を組み合わせる場合は、以下の演算子を使用します。

|演算子|意味|
|---|---|
|&&|AND 両方の条件が真の場合に真|
|\||OR どちらかの条件が真の場合に真|

例えば、file1.txtファイルが存在して、file2txtが存在しない場合に処理を実行させる場合は以下のように記述します。

```bash
#!/bin/bash

if [ -e file1.txt ] && [ ! -e file2.txt ]; then
 echo "make file3.txt"
fi
```

今回紹介した条件式を使うことで、複雑な処理を実行することができます。