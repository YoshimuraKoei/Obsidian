---
title: Next.jsで学ぶReact講座
AI: 
published: 2025-07-01
description: useMemoの使い方、useRouterの使い方
tags:
  - permanent-note
  - react
  - nextjs
  - programming
---
---
useMemo ... Reactの機能
useRouter ... Next.jsの機能

```
export const useCounter = () => {
  const [count, setCount] = useState(1);
  const [isShow, setIsShow] = useState(true);

  const doubleCount = count * 2; // これだとisShowが変更されると作り直されてしまい、パフォーマンスが低下。
  
　const handleClick = useCallback(() => {
    setCount((prevCount) => prevCount + 1);
  }, []);

  const handleDisplay = useCallback(() => {
    setIsShow((prevShow) => !prevShow);
  }, []);

  return { count, isShow, handleClick, handleDisplay, doubleCount };
};
```

`const doubleCount = count * 2` ではなく、

```
const doubleCount = useMemo(() => {
	return count * 2;
}, [count])
```

とすることで、countが変更した場合にのみ再生成されるようになる。

##### しまぶーの意見
Reactのすべてのコンポーネントに対して、
- 変数に対してはuseMemo
- 関数に対してはuseCallback
を使うべき。しかし逆にuseMemo、useCallbackを必要でない場合は、逆に少しパフォーマンスが悪くなる場合も。**それは計算ロジックによるもの**で、微々たるもの。慣れないうちは、とりあえずすべてつけておけば大丈夫。そうするとパフォーマンスに対する意識も高まる。

##### useRouter

```
export const useBgColor = (count) => {
  const router = useRouter();

  console.log("router", router);

  const bgColor = useMemo(() => {
    switch (router.pathname) {
      case "/":
        return "lightblue";
      case "/about":
        return "beige";
      default:
        return "";
    }
  }, [router.pathname]);

  useEffect(() => {
    console.log("count", count);
    document.body.style.backgroundColor = bgColor;
    return () => {
      document.body.style.backgroundColor = "";
    };
  }, [bgColor]);
};

```

##### 通常の関数とアロー関数の違い

最近のJavaScript、TypeScriptで使い分ける理由は特にない。アロー関数であるとfunctionはTypeScriptでの型定義がやりにくい。
