---
title: Next.jsで学ぶReact講座
AI: "false"
published: 2025-06-28
description: useEffectやuseCallbackの第2引数の配列について理解を深めよう
tags:
  - permanent-note
  - react
  - nextjs
  - programming
---
---
```
useEffect(() => {
	console.log("count", count);
	document.body.style.backgroundColor = "lightblue";

	return () => {
	  document.body.style.backgroundColor = "";
	};
}, [count]);
```

countが変化した場合に、マウント処理だけでなくアンマウント処理も呼ばれる。アンマウント処理が呼ばれたあと、マウント時の処理が呼ばれる。これがコンポーネントライフサイクル。

ちなみに、useEffectの第二引数の配列には、何個でも変数が入れられる。


```
const handleClick = useCallback(() => 
	console.log(count); // countは更新されない
	if (count < 10) {
		setCount((count) => count + 1); // 数は増加していく
	}
}, []);
```

useCallbackの第二引数に何も指定しない場合、useCallbackが再生成されることがないので、関数は更新されない。

```
const handleClick = useCallback((e) => {
	console.log(count);
	if (count < 10) {
		setCount((count) => count + 1);
	}
}, [count]);
```

countが変わるたびに関数が更新される。再生成させるものと、再生成される必要がないものに分けていくのがパフォーマンスを悪くしないコツ。

